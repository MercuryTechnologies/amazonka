<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      : Network.AWS.Auth</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   : (c) 2013-2021 Brendan Hay</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     : Mozilla Public License, v. 2.0.</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Maintainer  : Brendan Hay &lt;brendan.g.hay+amazonka@gmail.com&gt;</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Stability   : provisional</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Portability : non-portable (GHC extensions)</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Explicitly specify your Amazon AWS security credentials, or retrieve them</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- from the underlying OS.</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- The format of environment variables and the credentials file follows the official</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- &lt;http://blogs.aws.amazon.com/security/post/Tx3D6U6WSFGOK2H/A-New-and-Standardized-Way-to-Manage-Credentials-in-the-AWS-SDKs AWS SDK guidelines&gt;.</span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Network.AWS.Auth</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Authentication</span></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Retrieving Authentication</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#getAuth"><span class="hs-identifier">getAuth</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#Credentials"><span class="hs-identifier">Credentials</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier">Auth</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Defaults</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** Environment</span></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#envAccessKey"><span class="hs-identifier">envAccessKey</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#envSecretKey"><span class="hs-identifier">envSecretKey</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#envSessionToken"><span class="hs-identifier">envSessionToken</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Configuration</span></span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#confRegion"><span class="hs-identifier">confRegion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#confFile"><span class="hs-identifier">confFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** Credentials File</span></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#credAccessKey"><span class="hs-identifier">credAccessKey</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#credSecretKey"><span class="hs-identifier">credSecretKey</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#credSessionToken"><span class="hs-identifier">credSessionToken</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#credProfile"><span class="hs-identifier">credProfile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#credFile"><span class="hs-identifier">credFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Credentials</span></span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><span class="hs-comment">-- $credentials</span></span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#fromKeys"><span class="hs-identifier">fromKeys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#fromSession"><span class="hs-identifier">fromSession</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#fromTemporarySession"><span class="hs-identifier">fromTemporarySession</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#fromEnv"><span class="hs-identifier">fromEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#fromEnvKeys"><span class="hs-identifier">fromEnvKeys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#fromFile"><span class="hs-identifier">fromFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#fromFilePath"><span class="hs-identifier">fromFilePath</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#fromProfile"><span class="hs-identifier">fromProfile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#fromProfileName"><span class="hs-identifier">fromProfileName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#fromContainer"><span class="hs-identifier">fromContainer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Keys</span></span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="Network.AWS.Types.html#AccessKey"><span class="hs-identifier">AccessKey</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="Network.AWS.Types.html#SecretKey"><span class="hs-identifier">SecretKey</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="Network.AWS.Types.html#SessionToken"><span class="hs-identifier">SessionToken</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Handling Errors</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#AsAuthError"><span class="hs-identifier">AsAuthError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#AuthError"><span class="hs-identifier">AuthError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">where</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ThreadId</span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Concurrent</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Exception</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MaybeT</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS8</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LBS8</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Char</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.IORef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IORef</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IORef</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IORef</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ini</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">INI</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Time</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.AWS.Data.html"><span class="hs-identifier">Network.AWS.Data</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.AWS.EC2.Metadata.html"><span class="hs-identifier">Network.AWS.EC2.Metadata</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.AWS.Lens.html"><span class="hs-identifier">Network.AWS.Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catching</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">catching_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">exception</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">prism</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">throwingM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_IOException</span></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.AWS.Prelude.html"><span class="hs-identifier">Network.AWS.Prelude</span></a></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.AWS.Types.html"><span class="hs-identifier">Network.AWS.Types</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Client</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Client</span></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Directory</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.Environment</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Environment</span></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Mem.Weak</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Weak</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.Mem.Weak</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Weak</span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- | Default access key environment variable.</span><span>
</span><span id="line-91"></span><span class="annot"><a href="Network.AWS.Auth.html#envAccessKey"><span class="hs-identifier hs-type">envAccessKey</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-comment">-- | AWS_ACCESS_KEY_ID</span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-94"></span><span id="envAccessKey"><span class="annot"><span class="annottext">envAccessKey :: Text
</span><a href="Network.AWS.Auth.html#envAccessKey"><span class="hs-identifier hs-var hs-var">envAccessKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;AWS_ACCESS_KEY_ID&quot;</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | Default secret key environment variable.</span><span>
</span><span id="line-97"></span><span class="annot"><a href="Network.AWS.Auth.html#envSecretKey"><span class="hs-identifier hs-type">envSecretKey</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-comment">-- | AWS_SECRET_ACCESS_KEY</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-100"></span><span id="envSecretKey"><span class="annot"><span class="annottext">envSecretKey :: Text
</span><a href="Network.AWS.Auth.html#envSecretKey"><span class="hs-identifier hs-var hs-var">envSecretKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;AWS_SECRET_ACCESS_KEY&quot;</span></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | Default session token environment variable.</span><span>
</span><span id="line-103"></span><span class="annot"><a href="Network.AWS.Auth.html#envSessionToken"><span class="hs-identifier hs-type">envSessionToken</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-comment">-- | AWS_SESSION_TOKEN</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-106"></span><span id="envSessionToken"><span class="annot"><span class="annottext">envSessionToken :: Text
</span><a href="Network.AWS.Auth.html#envSessionToken"><span class="hs-identifier hs-var hs-var">envSessionToken</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;AWS_SESSION_TOKEN&quot;</span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Default credentials profile environment variable.</span><span>
</span><span id="line-109"></span><span class="annot"><a href="Network.AWS.Auth.html#envProfile"><span class="hs-identifier hs-type">envProfile</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-comment">-- | AWS_PROFILE</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-112"></span><span id="envProfile"><span class="annot"><span class="annottext">envProfile :: Text
</span><a href="Network.AWS.Auth.html#envProfile"><span class="hs-identifier hs-var hs-var">envProfile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;AWS_PROFILE&quot;</span></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | Default region environment variable</span><span>
</span><span id="line-115"></span><span class="annot"><a href="Network.AWS.Auth.html#envRegion"><span class="hs-identifier hs-type">envRegion</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-comment">-- | AWS_REGION</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-118"></span><span id="envRegion"><span class="annot"><span class="annottext">envRegion :: Text
</span><a href="Network.AWS.Auth.html#envRegion"><span class="hs-identifier hs-var hs-var">envRegion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;AWS_REGION&quot;</span></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- | Path to obtain container credentials environment variable (see</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- 'FromContainer').</span><span>
</span><span id="line-122"></span><span class="annot"><a href="Network.AWS.Auth.html#envContainerCredentialsURI"><span class="hs-identifier hs-type">envContainerCredentialsURI</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-comment">-- | AWS_CONTAINER_CREDENTIALS_RELATIVE_URI</span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-125"></span><span id="envContainerCredentialsURI"><span class="annot"><span class="annottext">envContainerCredentialsURI :: Text
</span><a href="Network.AWS.Auth.html#envContainerCredentialsURI"><span class="hs-identifier hs-var hs-var">envContainerCredentialsURI</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;AWS_CONTAINER_CREDENTIALS_RELATIVE_URI&quot;</span></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | Credentials INI file access key variable.</span><span>
</span><span id="line-128"></span><span class="annot"><a href="Network.AWS.Auth.html#credAccessKey"><span class="hs-identifier hs-type">credAccessKey</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-comment">-- | aws_access_key_id</span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-131"></span><span id="credAccessKey"><span class="annot"><span class="annottext">credAccessKey :: Text
</span><a href="Network.AWS.Auth.html#credAccessKey"><span class="hs-identifier hs-var hs-var">credAccessKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;aws_access_key_id&quot;</span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- | Credentials INI file secret key variable.</span><span>
</span><span id="line-134"></span><span class="annot"><a href="Network.AWS.Auth.html#credSecretKey"><span class="hs-identifier hs-type">credSecretKey</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-comment">-- | aws_secret_access_key</span><span>
</span><span id="line-136"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-137"></span><span id="credSecretKey"><span class="annot"><span class="annottext">credSecretKey :: Text
</span><a href="Network.AWS.Auth.html#credSecretKey"><span class="hs-identifier hs-var hs-var">credSecretKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;aws_secret_access_key&quot;</span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- | Credentials INI file session token variable.</span><span>
</span><span id="line-140"></span><span class="annot"><a href="Network.AWS.Auth.html#credSessionToken"><span class="hs-identifier hs-type">credSessionToken</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-comment">-- | aws_session_token</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-143"></span><span id="credSessionToken"><span class="annot"><span class="annottext">credSessionToken :: Text
</span><a href="Network.AWS.Auth.html#credSessionToken"><span class="hs-identifier hs-var hs-var">credSessionToken</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;aws_session_token&quot;</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">-- | Credentials INI default profile section variable.</span><span>
</span><span id="line-146"></span><span class="annot"><a href="Network.AWS.Auth.html#credProfile"><span class="hs-identifier hs-type">credProfile</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-comment">-- | default</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-149"></span><span id="credProfile"><span class="annot"><span class="annottext">credProfile :: Text
</span><a href="Network.AWS.Auth.html#credProfile"><span class="hs-identifier hs-var hs-var">credProfile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;default&quot;</span></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- | Default path for the credentials file. This looks in in the @HOME@ directory</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- as determined by the &lt;http://hackage.haskell.org/package/directory directory&gt;</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- library.</span><span>
</span><span id="line-154"></span><span class="hs-comment">--</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- * UNIX/OSX: @$HOME/.aws/credentials@</span><span>
</span><span id="line-156"></span><span class="hs-comment">--</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- * Windows: @C:\/Users\//\&lt;user\&gt;\.aws\credentials@</span><span>
</span><span id="line-158"></span><span class="hs-comment">--</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- /Note:/ This does not match the default AWS SDK location of</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- @%USERPROFILE%\.aws\credentials@ on Windows. (Sorry.)</span><span>
</span><span id="line-161"></span><span id="local-6989586621679200887"><span class="annot"><a href="Network.AWS.Auth.html#credFile"><span class="hs-identifier hs-type">credFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679200887"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679200887"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span></span><span>
</span><span id="line-162"></span><span id="credFile"><span class="annot"><span class="annottext">credFile :: m FilePath
</span><a href="Network.AWS.Auth.html#credFile"><span class="hs-identifier hs-var hs-var">credFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; m FilePath
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting (First IOException) SomeException IOException
-&gt; IO FilePath -&gt; IO FilePath -&gt; IO FilePath
forall (m :: * -&gt; *) a r.
MonadCatch m =&gt;
Getting (First a) SomeException a -&gt; m r -&gt; m r -&gt; m r
</span><span class="hs-identifier hs-var">catching_</span></span><span> </span><span class="annot"><span class="annottext">Getting (First IOException) SomeException IOException
forall t. AsIOException t =&gt; Prism' t IOException
</span><span class="hs-identifier hs-var">_IOException</span></span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><a href="#local-6989586621679200799"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><a href="#local-6989586621679200798"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621679200799"><span class="annot"><span class="annottext">dir :: IO FilePath
</span><a href="#local-6989586621679200799"><span class="hs-identifier hs-var hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200797"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; IO FilePath -&gt; IO FilePath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><span class="hs-identifier hs-var">Directory.getHomeDirectory</span></span><span>
</span><span id="line-165"></span><span>    </span><span id="local-6989586621679200798"><span class="annot"><span class="annottext">err :: IO FilePath
</span><a href="#local-6989586621679200798"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AuthError -&gt; IO FilePath
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">Exception.throwIO</span></span><span> </span><span class="annot"><span class="annottext">(AuthError -&gt; IO FilePath) -&gt; AuthError -&gt; IO FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; AuthError
</span><a href="Network.AWS.Auth.html#MissingFileError"><span class="hs-identifier hs-var">MissingFileError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;$HOME&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200797"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621679200797"><span class="annot"><span class="annottext">path :: FilePath
</span><a href="#local-6989586621679200797"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;/.aws/credentials&quot;</span></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">-- | Credentials INI default profile section variable.</span><span>
</span><span id="line-170"></span><span class="annot"><a href="Network.AWS.Auth.html#confRegion"><span class="hs-identifier hs-type">confRegion</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-comment">-- | default</span><span>
</span><span id="line-172"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-173"></span><span id="confRegion"><span class="annot"><span class="annottext">confRegion :: Text
</span><a href="Network.AWS.Auth.html#confRegion"><span class="hs-identifier hs-var hs-var">confRegion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;region&quot;</span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Default path for the configuration file. This looks in in the @HOME@ directory</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- as determined by the &lt;http://hackage.haskell.org/package/directory directory&gt;</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- library.</span><span>
</span><span id="line-178"></span><span class="hs-comment">--</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- * UNIX/OSX: @$HOME/.aws/config@</span><span>
</span><span id="line-180"></span><span class="hs-comment">--</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- * Windows: @C:\/Users\//\&lt;user\&gt;\.aws\config@</span><span>
</span><span id="line-182"></span><span class="hs-comment">--</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- /Note:/ This does not match the default AWS SDK location of</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- @%USERPROFILE%\.aws\config@ on Windows. (Sorry.)</span><span>
</span><span id="line-185"></span><span id="local-6989586621679200792"><span class="annot"><a href="Network.AWS.Auth.html#confFile"><span class="hs-identifier hs-type">confFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679200792"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679200792"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span></span><span>
</span><span id="line-186"></span><span id="confFile"><span class="annot"><span class="annottext">confFile :: m FilePath
</span><a href="Network.AWS.Auth.html#confFile"><span class="hs-identifier hs-var hs-var">confFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; m FilePath
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting (First IOException) SomeException IOException
-&gt; IO FilePath -&gt; IO FilePath -&gt; IO FilePath
forall (m :: * -&gt; *) a r.
MonadCatch m =&gt;
Getting (First a) SomeException a -&gt; m r -&gt; m r -&gt; m r
</span><span class="hs-identifier hs-var">catching_</span></span><span> </span><span class="annot"><span class="annottext">Getting (First IOException) SomeException IOException
forall t. AsIOException t =&gt; Prism' t IOException
</span><span class="hs-identifier hs-var">_IOException</span></span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><a href="#local-6989586621679200791"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><a href="#local-6989586621679200790"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679200791"><span class="annot"><span class="annottext">dir :: IO FilePath
</span><a href="#local-6989586621679200791"><span class="hs-identifier hs-var hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200789"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; IO FilePath -&gt; IO FilePath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; IO FilePath
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><span class="hs-identifier hs-var">Directory.getHomeDirectory</span></span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679200790"><span class="annot"><span class="annottext">err :: IO FilePath
</span><a href="#local-6989586621679200790"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AuthError -&gt; IO FilePath
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">Exception.throwIO</span></span><span> </span><span class="annot"><span class="annottext">(AuthError -&gt; IO FilePath) -&gt; AuthError -&gt; IO FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; AuthError
</span><a href="Network.AWS.Auth.html#MissingFileError"><span class="hs-identifier hs-var">MissingFileError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;$HOME&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200789"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679200789"><span class="annot"><span class="annottext">path :: FilePath
</span><a href="#local-6989586621679200789"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;/.aws/config&quot;</span></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- $credentials</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- 'getAuth' is implemented using the following @from*@-styled functions below.</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- Both 'fromKeys' and 'fromSession' can be used directly to avoid the 'MonadIO'</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- constraint.</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- | Explicit access and secret keys.</span><span>
</span><span id="line-199"></span><span class="annot"><a href="Network.AWS.Auth.html#fromKeys"><span class="hs-identifier hs-type">fromKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.AWS.Types.html#AccessKey"><span class="hs-identifier hs-type">AccessKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.AWS.Types.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-type">Auth</span></a></span><span>
</span><span id="line-200"></span><span id="fromKeys"><span class="annot"><span class="annottext">fromKeys :: AccessKey -&gt; SecretKey -&gt; Auth
</span><a href="Network.AWS.Auth.html#fromKeys"><span class="hs-identifier hs-var hs-var">fromKeys</span></a></span></span><span> </span><span id="local-6989586621679200788"><span class="annot"><span class="annottext">AccessKey
</span><a href="#local-6989586621679200788"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679200787"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679200787"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AuthEnv -&gt; Auth
</span><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-var">Auth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AccessKey
-&gt; Sensitive SecretKey
-&gt; Maybe (Sensitive SessionToken)
-&gt; Maybe ISO8601
-&gt; AuthEnv
</span><a href="Network.AWS.Types.html#AuthEnv"><span class="hs-identifier hs-var">AuthEnv</span></a></span><span> </span><span class="annot"><span class="annottext">AccessKey
</span><a href="#local-6989586621679200788"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SecretKey -&gt; Sensitive SecretKey
forall a. a -&gt; Sensitive a
</span><a href="Network.AWS.Data.Sensitive.html#Sensitive"><span class="hs-identifier hs-var">Sensitive</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679200787"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Sensitive SessionToken)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe ISO8601
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | Temporary credentials from a STS session consisting of</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- the access key, secret key, and session token.</span><span>
</span><span id="line-204"></span><span class="hs-comment">--</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- /See:/ 'fromTemporarySession'</span><span>
</span><span id="line-206"></span><span class="annot"><a href="Network.AWS.Auth.html#fromSession"><span class="hs-identifier hs-type">fromSession</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.AWS.Types.html#AccessKey"><span class="hs-identifier hs-type">AccessKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.AWS.Types.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.AWS.Types.html#SessionToken"><span class="hs-identifier hs-type">SessionToken</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-type">Auth</span></a></span><span>
</span><span id="line-207"></span><span id="fromSession"><span class="annot"><span class="annottext">fromSession :: AccessKey -&gt; SecretKey -&gt; SessionToken -&gt; Auth
</span><a href="Network.AWS.Auth.html#fromSession"><span class="hs-identifier hs-var hs-var">fromSession</span></a></span></span><span> </span><span id="local-6989586621679200783"><span class="annot"><span class="annottext">AccessKey
</span><a href="#local-6989586621679200783"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679200782"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679200782"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679200781"><span class="annot"><span class="annottext">SessionToken
</span><a href="#local-6989586621679200781"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span>  </span><span class="annot"><span class="annottext">AuthEnv -&gt; Auth
</span><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-var">Auth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AccessKey
-&gt; Sensitive SecretKey
-&gt; Maybe (Sensitive SessionToken)
-&gt; Maybe ISO8601
-&gt; AuthEnv
</span><a href="Network.AWS.Types.html#AuthEnv"><span class="hs-identifier hs-var">AuthEnv</span></a></span><span> </span><span class="annot"><span class="annottext">AccessKey
</span><a href="#local-6989586621679200783"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SecretKey -&gt; Sensitive SecretKey
forall a. a -&gt; Sensitive a
</span><a href="Network.AWS.Data.Sensitive.html#Sensitive"><span class="hs-identifier hs-var">Sensitive</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679200782"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sensitive SessionToken -&gt; Maybe (Sensitive SessionToken)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SessionToken -&gt; Sensitive SessionToken
forall a. a -&gt; Sensitive a
</span><a href="Network.AWS.Data.Sensitive.html#Sensitive"><span class="hs-identifier hs-var">Sensitive</span></a></span><span> </span><span class="annot"><span class="annottext">SessionToken
</span><a href="#local-6989586621679200781"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ISO8601
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Temporary credentials from a STS session consisting of</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- the access key, secret key, session token, and expiration time.</span><span>
</span><span id="line-212"></span><span class="hs-comment">--</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- /See:/ 'fromSession'</span><span>
</span><span id="line-214"></span><span class="annot"><a href="Network.AWS.Auth.html#fromTemporarySession"><span class="hs-identifier hs-type">fromTemporarySession</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><a href="Network.AWS.Types.html#AccessKey"><span class="hs-identifier hs-type">AccessKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-216"></span><span>  </span><span class="annot"><a href="Network.AWS.Types.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><a href="Network.AWS.Types.html#SessionToken"><span class="hs-identifier hs-type">SessionToken</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-type">Auth</span></a></span><span>
</span><span id="line-220"></span><span id="fromTemporarySession"><span class="annot"><span class="annottext">fromTemporarySession :: AccessKey -&gt; SecretKey -&gt; SessionToken -&gt; UTCTime -&gt; Auth
</span><a href="Network.AWS.Auth.html#fromTemporarySession"><span class="hs-identifier hs-var hs-var">fromTemporarySession</span></a></span></span><span> </span><span id="local-6989586621679200780"><span class="annot"><span class="annottext">AccessKey
</span><a href="#local-6989586621679200780"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679200779"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679200779"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679200778"><span class="annot"><span class="annottext">SessionToken
</span><a href="#local-6989586621679200778"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679200777"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679200777"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><span class="annottext">AuthEnv -&gt; Auth
</span><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-var">Auth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AccessKey
-&gt; Sensitive SecretKey
-&gt; Maybe (Sensitive SessionToken)
-&gt; Maybe ISO8601
-&gt; AuthEnv
</span><a href="Network.AWS.Types.html#AuthEnv"><span class="hs-identifier hs-var">AuthEnv</span></a></span><span> </span><span class="annot"><span class="annottext">AccessKey
</span><a href="#local-6989586621679200780"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SecretKey -&gt; Sensitive SecretKey
forall a. a -&gt; Sensitive a
</span><a href="Network.AWS.Data.Sensitive.html#Sensitive"><span class="hs-identifier hs-var">Sensitive</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679200779"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sensitive SessionToken -&gt; Maybe (Sensitive SessionToken)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SessionToken -&gt; Sensitive SessionToken
forall a. a -&gt; Sensitive a
</span><a href="Network.AWS.Data.Sensitive.html#Sensitive"><span class="hs-identifier hs-var">Sensitive</span></a></span><span> </span><span class="annot"><span class="annottext">SessionToken
</span><a href="#local-6989586621679200778"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ISO8601 -&gt; Maybe ISO8601
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime -&gt; ISO8601
forall (a :: Format). UTCTime -&gt; Time a
</span><a href="Network.AWS.Data.Time.html#Time"><span class="hs-identifier hs-var">Time</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679200777"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- | Determines how AuthN/AuthZ information is retrieved.</span><span>
</span><span id="line-224"></span><span id="local-6989586621679200774"><span id="local-6989586621679200775"></span></span><span class="hs-keyword">data</span><span> </span><span id="Credentials"><span class="annot"><a href="Network.AWS.Auth.html#Credentials"><span class="hs-identifier hs-var">Credentials</span></a></span></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Explicit access and secret keys. See 'fromKeys'.</span><span>
</span><span id="line-226"></span><span>    </span><span id="FromKeys"><span class="annot"><a href="Network.AWS.Auth.html#FromKeys"><span class="hs-identifier hs-var">FromKeys</span></a></span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#AccessKey"><span class="hs-identifier hs-type">AccessKey</span></a></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Explicit access key, secret key and a session token. See 'fromSession'.</span><span>
</span><span id="line-228"></span><span>    </span><span id="FromSession"><span class="annot"><a href="Network.AWS.Auth.html#FromSession"><span class="hs-identifier hs-var">FromSession</span></a></span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#AccessKey"><span class="hs-identifier hs-type">AccessKey</span></a></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#SessionToken"><span class="hs-identifier hs-type">SessionToken</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Lookup specific environment variables for access key, secret key,</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-comment">-- an optional session token, and an optional region, respectively.</span><span>
</span><span id="line-231"></span><span>    </span><span id="FromEnv"><span class="annot"><a href="Network.AWS.Auth.html#FromEnv"><span class="hs-identifier hs-var">FromEnv</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | An IAM Profile name to lookup from the local EC2 instance-data.</span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-comment">-- Environment variables to lookup for the access key, secret key and</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-comment">-- optional session token.</span><span>
</span><span id="line-235"></span><span>    </span><span id="FromProfile"><span class="annot"><a href="Network.AWS.Auth.html#FromProfile"><span class="hs-identifier hs-var">FromProfile</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | A credentials profile name (the INI section), the path to the AWS</span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-comment">-- &lt;http://blogs.aws.amazon.com/security/post/Tx3D6U6WSFGOK2H/A-New-and-Standardized-Way-to-Manage-Credentials-in-the-AWS-SDKs credentials&gt; file,</span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-comment">-- and the path to the @~/.aws/config@ file.</span><span>
</span><span id="line-239"></span><span>    </span><span id="FromFile"><span class="annot"><a href="Network.AWS.Auth.html#FromFile"><span class="hs-identifier hs-var">FromFile</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Obtain credentials by attempting to contact the ECS container agent</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-comment">-- at &lt;http://169.254.170.2&gt; using the path in 'envContainerCredentialsURI'.</span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-comment">-- See &lt;http://docs.aws.amazon.com/AmazonECS/latest/developerguide/task-iam-roles.html IAM Roles for Tasks&gt;</span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-comment">-- in the AWS documentation for more information.</span><span>
</span><span id="line-244"></span><span>    </span><span id="FromContainer"><span class="annot"><a href="Network.AWS.Auth.html#FromContainer"><span class="hs-identifier hs-var">FromContainer</span></a></span></span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Attempt credentials discovery via the following steps:</span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-comment">-- * Read the 'envAccessKey', 'envSecretKey', and 'envRegion' from the environment if they are set.</span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-comment">-- * Read the credentials file if 'credFile' exists.</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-comment">-- * Obtain credentials from the ECS container agent if</span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-comment">-- 'envContainerCredentialsURI' is set.</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-comment">-- * Retrieve the first available IAM profile and read</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-comment">-- the 'Region' from the instance identity document, if running on EC2.</span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-comment">-- An attempt is made to resolve &lt;http://instance-data&gt; rather than directly</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-comment">-- retrieving &lt;http://169.254.169.254&gt; for IAM profile information.</span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-comment">-- This assists in ensuring the DNS lookup terminates promptly if not</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-comment">-- running on EC2.</span><span>
</span><span id="line-261"></span><span>    </span><span id="Discover"><span class="annot"><a href="Network.AWS.Auth.html#Discover"><span class="hs-identifier hs-var">Discover</span></a></span></span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679200763"><span id="local-6989586621679200765"><span class="annot"><span class="annottext">Credentials -&gt; Credentials -&gt; Bool
(Credentials -&gt; Credentials -&gt; Bool)
-&gt; (Credentials -&gt; Credentials -&gt; Bool) -&gt; Eq Credentials
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Credentials -&gt; Credentials -&gt; Bool
$c/= :: Credentials -&gt; Credentials -&gt; Bool
== :: Credentials -&gt; Credentials -&gt; Bool
$c== :: Credentials -&gt; Credentials -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. Credentials -&gt; Rep Credentials x)
-&gt; (forall x. Rep Credentials x -&gt; Credentials)
-&gt; Generic Credentials
forall x. Rep Credentials x -&gt; Credentials
forall x. Credentials -&gt; Rep Credentials x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Credentials x -&gt; Credentials
$cfrom :: forall x. Credentials -&gt; Rep Credentials x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.AWS.Data.Log.html#ToLog"><span class="hs-identifier hs-type">ToLog</span></a></span><span> </span><span class="annot"><a href="Network.AWS.Auth.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621679200756"><span class="annot"><span class="annottext">build :: Credentials -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var hs-var hs-var hs-var">build</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-266"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#FromKeys"><span class="hs-identifier hs-type">FromKeys</span></a></span><span> </span><span id="local-6989586621679200754"><span class="annot"><span class="annottext">AccessKey
</span><a href="#local-6989586621679200754"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-267"></span><span>      </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;FromKeys &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AccessKey -&gt; ByteStringBuilder
forall a. ToLog a =&gt; a -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">AccessKey
</span><a href="#local-6989586621679200754"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot; ****&quot;</span></span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#FromSession"><span class="hs-identifier hs-type">FromSession</span></a></span><span> </span><span id="local-6989586621679200753"><span class="annot"><span class="annottext">AccessKey
</span><a href="#local-6989586621679200753"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SessionToken
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-269"></span><span>      </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;FromSession &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AccessKey -&gt; ByteStringBuilder
forall a. ToLog a =&gt; a -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">AccessKey
</span><a href="#local-6989586621679200753"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot; **** ****&quot;</span></span><span>
</span><span id="line-270"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#FromEnv"><span class="hs-identifier hs-type">FromEnv</span></a></span><span> </span><span id="local-6989586621679200752"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200752"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679200751"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200751"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679200750"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679200750"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679200749"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679200749"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-271"></span><span>      </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;FromEnv &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteStringBuilder
forall a. ToLog a =&gt; a -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200752"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteStringBuilder
forall a. ToLog a =&gt; a -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200751"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; ByteStringBuilder
forall a. ToLog a =&gt; Maybe a -&gt; ByteStringBuilder
</span><a href="#local-6989586621679200748"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679200750"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; ByteStringBuilder
forall a. ToLog a =&gt; Maybe a -&gt; ByteStringBuilder
</span><a href="#local-6989586621679200748"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679200749"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#FromProfile"><span class="hs-identifier hs-type">FromProfile</span></a></span><span> </span><span id="local-6989586621679200747"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200747"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-273"></span><span>      </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;FromProfile &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteStringBuilder
forall a. ToLog a =&gt; a -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200747"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#FromFile"><span class="hs-identifier hs-type">FromFile</span></a></span><span> </span><span id="local-6989586621679200746"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200746"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679200745"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200745"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679200744"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200744"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-275"></span><span>      </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;FromFile &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteStringBuilder
forall a. ToLog a =&gt; a -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200746"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ByteStringBuilder
forall a. ToLog a =&gt; a -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200745"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ByteStringBuilder
forall a. ToLog a =&gt; a -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200744"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><span class="annottext">Credentials
</span><a href="Network.AWS.Auth.html#FromContainer"><span class="hs-identifier hs-var">FromContainer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-277"></span><span>      </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;FromContainer&quot;</span></span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><span class="annottext">Credentials
</span><a href="Network.AWS.Auth.html#Discover"><span class="hs-identifier hs-var">Discover</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-279"></span><span>      </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;Discover&quot;</span></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>      </span><span id="local-6989586621679200748"><span class="annot"><span class="annottext">m :: Maybe a -&gt; ByteStringBuilder
</span><a href="#local-6989586621679200748"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679200743"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679200743"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;(Just &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ByteStringBuilder
forall a. ToLog a =&gt; a -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679200743"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><a href="#local-6989586621679200748"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;Nothing&quot;</span></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679200738"><span id="local-6989586621679200741"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Network.AWS.Auth.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621679200736"><span class="annot"><span class="annottext">show :: Credentials -&gt; FilePath
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; FilePath
</span><span class="hs-identifier hs-var">BS8.unpack</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; FilePath)
-&gt; (Credentials -&gt; ByteString) -&gt; Credentials -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteString
forall a. ToByteString a =&gt; a -&gt; ByteString
</span><a href="Network.AWS.Data.ByteString.html#toBS"><span class="hs-identifier hs-var">toBS</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteStringBuilder -&gt; ByteString)
-&gt; (Credentials -&gt; ByteStringBuilder) -&gt; Credentials -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Credentials -&gt; ByteStringBuilder
forall a. ToLog a =&gt; a -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var">build</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-comment">-- | An error thrown when attempting to read AuthN/AuthZ information.</span><span>
</span><span id="line-288"></span><span id="local-6989586621679200730"><span id="local-6989586621679200731"></span></span><span class="hs-keyword">data</span><span> </span><span id="AuthError"><span class="annot"><a href="Network.AWS.Auth.html#AuthError"><span class="hs-identifier hs-var">AuthError</span></a></span></span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="RetrievalError"><span class="annot"><a href="Network.AWS.Auth.html#RetrievalError"><span class="hs-identifier hs-var">RetrievalError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HttpException</span></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MissingEnvError"><span class="annot"><a href="Network.AWS.Auth.html#MissingEnvError"><span class="hs-identifier hs-var">MissingEnvError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="InvalidEnvError"><span class="annot"><a href="Network.AWS.Auth.html#InvalidEnvError"><span class="hs-identifier hs-var">InvalidEnvError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MissingFileError"><span class="annot"><a href="Network.AWS.Auth.html#MissingFileError"><span class="hs-identifier hs-var">MissingFileError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="InvalidFileError"><span class="annot"><a href="Network.AWS.Auth.html#InvalidFileError"><span class="hs-identifier hs-var">InvalidFileError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="InvalidIAMError"><span class="annot"><a href="Network.AWS.Auth.html#InvalidIAMError"><span class="hs-identifier hs-var">InvalidIAMError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679200719"><span id="local-6989586621679200721"><span id="local-6989586621679200723"><span class="annot"><span class="annottext">Int -&gt; AuthError -&gt; FilePath -&gt; FilePath
[AuthError] -&gt; FilePath -&gt; FilePath
AuthError -&gt; FilePath
(Int -&gt; AuthError -&gt; FilePath -&gt; FilePath)
-&gt; (AuthError -&gt; FilePath)
-&gt; ([AuthError] -&gt; FilePath -&gt; FilePath)
-&gt; Show AuthError
forall a.
(Int -&gt; a -&gt; FilePath -&gt; FilePath)
-&gt; (a -&gt; FilePath) -&gt; ([a] -&gt; FilePath -&gt; FilePath) -&gt; Show a
showList :: [AuthError] -&gt; FilePath -&gt; FilePath
$cshowList :: [AuthError] -&gt; FilePath -&gt; FilePath
show :: AuthError -&gt; FilePath
$cshow :: AuthError -&gt; FilePath
showsPrec :: Int -&gt; AuthError -&gt; FilePath -&gt; FilePath
$cshowsPrec :: Int -&gt; AuthError -&gt; FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. AuthError -&gt; Rep AuthError x)
-&gt; (forall x. Rep AuthError x -&gt; AuthError) -&gt; Generic AuthError
forall x. Rep AuthError x -&gt; AuthError
forall x. AuthError -&gt; Rep AuthError x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep AuthError x -&gt; AuthError
$cfrom :: forall x. AuthError -&gt; Rep AuthError x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679200709"><span id="local-6989586621679200711"><span id="local-6989586621679200713"><span class="annot"><span class="hs-identifier hs-type">Exception</span></span><span> </span><span class="annot"><a href="Network.AWS.Auth.html#AuthError"><span class="hs-identifier hs-type">AuthError</span></a></span></span></span></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.AWS.Data.Log.html#ToLog"><span class="hs-identifier hs-type">ToLog</span></a></span><span> </span><span class="annot"><a href="Network.AWS.Auth.html#AuthError"><span class="hs-identifier hs-type">AuthError</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>  </span><span id="local-6989586621679200706"><span class="annot"><span class="annottext">build :: AuthError -&gt; ByteStringBuilder
</span><a href="#local-6989586621679200706"><span class="hs-identifier hs-var hs-var hs-var hs-var">build</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#RetrievalError"><span class="hs-identifier hs-type">RetrievalError</span></a></span><span> </span><span id="local-6989586621679200705"><span class="annot"><span class="annottext">HttpException
</span><a href="#local-6989586621679200705"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HttpException -&gt; ByteStringBuilder
forall a. ToLog a =&gt; a -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">HttpException
</span><a href="#local-6989586621679200705"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#MissingEnvError"><span class="hs-identifier hs-type">MissingEnvError</span></a></span><span> </span><span id="local-6989586621679200704"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200704"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;[MissingEnvError]  { message = &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteStringBuilder
forall a. ToLog a =&gt; a -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200704"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#InvalidEnvError"><span class="hs-identifier hs-type">InvalidEnvError</span></a></span><span> </span><span id="local-6989586621679200703"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200703"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;[InvalidEnvError]  { message = &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteStringBuilder
forall a. ToLog a =&gt; a -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200703"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#MissingFileError"><span class="hs-identifier hs-type">MissingFileError</span></a></span><span> </span><span id="local-6989586621679200702"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200702"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;[MissingFileError] { path = &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ByteStringBuilder
forall a. ToLog a =&gt; a -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200702"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#InvalidFileError"><span class="hs-identifier hs-type">InvalidFileError</span></a></span><span> </span><span id="local-6989586621679200701"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200701"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;[InvalidFileError] { message = &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteStringBuilder
forall a. ToLog a =&gt; a -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200701"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#InvalidIAMError"><span class="hs-identifier hs-type">InvalidIAMError</span></a></span><span> </span><span id="local-6989586621679200700"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200700"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;[InvalidIAMError]  { message = &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteStringBuilder
forall a. ToLog a =&gt; a -&gt; ByteStringBuilder
</span><a href="Network.AWS.Data.Log.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200700"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder -&gt; ByteStringBuilder -&gt; ByteStringBuilder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteStringBuilder
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-keyword">class</span><span> </span><span id="AsAuthError"><span class="annot"><a href="Network.AWS.Auth.html#AsAuthError"><span class="hs-identifier hs-var">AsAuthError</span></a></span></span><span> </span><span id="local-6989586621679200970"><span class="annot"><a href="#local-6989586621679200970"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-comment">-- | A general authentication error.</span><span>
</span><span id="line-310"></span><span>  </span><span id="_AuthError"><span class="annot"><a href="Network.AWS.Auth.html#_AuthError"><span class="hs-identifier hs-type">_AuthError</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="#local-6989586621679200970"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Network.AWS.Auth.html#AuthError"><span class="hs-identifier hs-type">AuthError</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="annot"><a href="Network.AWS.Auth.html#_AuthError"><span class="hs-pragma hs-type">_AuthError</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-comment">-- | An error occured while communicating over HTTP with</span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-comment">-- the local metadata endpoint.</span><span>
</span><span id="line-316"></span><span>  </span><span id="_RetrievalError"><span class="annot"><a href="Network.AWS.Auth.html#_RetrievalError"><span class="hs-identifier hs-type">_RetrievalError</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="#local-6989586621679200970"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HttpException</span></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-comment">-- | The named environment variable was not found.</span><span>
</span><span id="line-319"></span><span>  </span><span id="_MissingEnvError"><span class="annot"><a href="Network.AWS.Auth.html#_MissingEnvError"><span class="hs-identifier hs-type">_MissingEnvError</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="#local-6989586621679200970"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-comment">-- | An error occured parsing named environment variable's value.</span><span>
</span><span id="line-322"></span><span>  </span><span id="_InvalidEnvError"><span class="annot"><a href="Network.AWS.Auth.html#_InvalidEnvError"><span class="hs-identifier hs-type">_InvalidEnvError</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="#local-6989586621679200970"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-comment">-- | The specified credentials file could not be found.</span><span>
</span><span id="line-325"></span><span>  </span><span id="_MissingFileError"><span class="annot"><a href="Network.AWS.Auth.html#_MissingFileError"><span class="hs-identifier hs-type">_MissingFileError</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="#local-6989586621679200970"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-comment">-- | An error occured parsing the credentials file.</span><span>
</span><span id="line-328"></span><span>  </span><span id="_InvalidFileError"><span class="annot"><a href="Network.AWS.Auth.html#_InvalidFileError"><span class="hs-identifier hs-type">_InvalidFileError</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="#local-6989586621679200970"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-comment">-- | The specified IAM profile could not be found or deserialised.</span><span>
</span><span id="line-331"></span><span>  </span><span id="_InvalidIAMError"><span class="annot"><a href="Network.AWS.Auth.html#_InvalidIAMError"><span class="hs-identifier hs-type">_InvalidIAMError</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="#local-6989586621679200970"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span>  </span><span id="local-6989586621679200692"><span class="annot"><a href="Network.AWS.Auth.html#_RetrievalError"><span class="hs-identifier hs-var hs-var">_RetrievalError</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p AuthError (f AuthError) -&gt; p a (f a)
forall a. AsAuthError a =&gt; Prism' a AuthError
</span><a href="Network.AWS.Auth.html#_AuthError"><span class="hs-identifier hs-var">_AuthError</span></a></span><span> </span><span class="annot"><span class="annottext">(p AuthError (f AuthError) -&gt; p a (f a))
-&gt; (p HttpException (f HttpException) -&gt; p AuthError (f AuthError))
-&gt; p HttpException (f HttpException)
-&gt; p a (f a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">p HttpException (f HttpException) -&gt; p AuthError (f AuthError)
forall a. AsAuthError a =&gt; Prism' a HttpException
</span><a href="Network.AWS.Auth.html#_RetrievalError"><span class="hs-identifier hs-var">_RetrievalError</span></a></span></span><span>
</span><span id="line-334"></span><span>  </span><span id="local-6989586621679200691"><span class="annot"><a href="Network.AWS.Auth.html#_MissingEnvError"><span class="hs-identifier hs-var hs-var">_MissingEnvError</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p AuthError (f AuthError) -&gt; p a (f a)
forall a. AsAuthError a =&gt; Prism' a AuthError
</span><a href="Network.AWS.Auth.html#_AuthError"><span class="hs-identifier hs-var">_AuthError</span></a></span><span> </span><span class="annot"><span class="annottext">(p AuthError (f AuthError) -&gt; p a (f a))
-&gt; (p Text (f Text) -&gt; p AuthError (f AuthError))
-&gt; p Text (f Text)
-&gt; p a (f a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">p Text (f Text) -&gt; p AuthError (f AuthError)
forall a. AsAuthError a =&gt; Prism' a Text
</span><a href="Network.AWS.Auth.html#_MissingEnvError"><span class="hs-identifier hs-var">_MissingEnvError</span></a></span></span><span>
</span><span id="line-335"></span><span>  </span><span id="local-6989586621679200690"><span class="annot"><a href="Network.AWS.Auth.html#_InvalidEnvError"><span class="hs-identifier hs-var hs-var">_InvalidEnvError</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p AuthError (f AuthError) -&gt; p a (f a)
forall a. AsAuthError a =&gt; Prism' a AuthError
</span><a href="Network.AWS.Auth.html#_AuthError"><span class="hs-identifier hs-var">_AuthError</span></a></span><span> </span><span class="annot"><span class="annottext">(p AuthError (f AuthError) -&gt; p a (f a))
-&gt; (p Text (f Text) -&gt; p AuthError (f AuthError))
-&gt; p Text (f Text)
-&gt; p a (f a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">p Text (f Text) -&gt; p AuthError (f AuthError)
forall a. AsAuthError a =&gt; Prism' a Text
</span><a href="Network.AWS.Auth.html#_InvalidEnvError"><span class="hs-identifier hs-var">_InvalidEnvError</span></a></span></span><span>
</span><span id="line-336"></span><span>  </span><span id="local-6989586621679200689"><span class="annot"><a href="Network.AWS.Auth.html#_MissingFileError"><span class="hs-identifier hs-var hs-var">_MissingFileError</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p AuthError (f AuthError) -&gt; p a (f a)
forall a. AsAuthError a =&gt; Prism' a AuthError
</span><a href="Network.AWS.Auth.html#_AuthError"><span class="hs-identifier hs-var">_AuthError</span></a></span><span> </span><span class="annot"><span class="annottext">(p AuthError (f AuthError) -&gt; p a (f a))
-&gt; (p FilePath (f FilePath) -&gt; p AuthError (f AuthError))
-&gt; p FilePath (f FilePath)
-&gt; p a (f a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">p FilePath (f FilePath) -&gt; p AuthError (f AuthError)
forall a. AsAuthError a =&gt; Prism' a FilePath
</span><a href="Network.AWS.Auth.html#_MissingFileError"><span class="hs-identifier hs-var">_MissingFileError</span></a></span></span><span>
</span><span id="line-337"></span><span>  </span><span id="local-6989586621679200688"><span class="annot"><a href="Network.AWS.Auth.html#_InvalidFileError"><span class="hs-identifier hs-var hs-var">_InvalidFileError</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p AuthError (f AuthError) -&gt; p a (f a)
forall a. AsAuthError a =&gt; Prism' a AuthError
</span><a href="Network.AWS.Auth.html#_AuthError"><span class="hs-identifier hs-var">_AuthError</span></a></span><span> </span><span class="annot"><span class="annottext">(p AuthError (f AuthError) -&gt; p a (f a))
-&gt; (p Text (f Text) -&gt; p AuthError (f AuthError))
-&gt; p Text (f Text)
-&gt; p a (f a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">p Text (f Text) -&gt; p AuthError (f AuthError)
forall a. AsAuthError a =&gt; Prism' a Text
</span><a href="Network.AWS.Auth.html#_InvalidFileError"><span class="hs-identifier hs-var">_InvalidFileError</span></a></span></span><span>
</span><span id="line-338"></span><span>  </span><span id="local-6989586621679200687"><span class="annot"><a href="Network.AWS.Auth.html#_InvalidIAMError"><span class="hs-identifier hs-var hs-var">_InvalidIAMError</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p AuthError (f AuthError) -&gt; p a (f a)
forall a. AsAuthError a =&gt; Prism' a AuthError
</span><a href="Network.AWS.Auth.html#_AuthError"><span class="hs-identifier hs-var">_AuthError</span></a></span><span> </span><span class="annot"><span class="annottext">(p AuthError (f AuthError) -&gt; p a (f a))
-&gt; (p Text (f Text) -&gt; p AuthError (f AuthError))
-&gt; p Text (f Text)
-&gt; p a (f a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">p Text (f Text) -&gt; p AuthError (f AuthError)
forall a. AsAuthError a =&gt; Prism' a Text
</span><a href="Network.AWS.Auth.html#_InvalidIAMError"><span class="hs-identifier hs-var">_InvalidIAMError</span></a></span></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679200674"><span id="local-6989586621679200676"><span id="local-6989586621679200678"><span id="local-6989586621679200680"><span id="local-6989586621679200682"><span id="local-6989586621679200684"><span class="annot"><a href="Network.AWS.Auth.html#AsAuthError"><span class="hs-identifier hs-type">AsAuthError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SomeException</span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-341"></span><span>  </span><span id="local-6989586621679200672"><span class="annot"><span class="annottext">_AuthError :: p AuthError (f AuthError) -&gt; p SomeException (f SomeException)
</span><a href="#local-6989586621679200672"><span class="hs-identifier hs-var hs-var hs-var hs-var">_AuthError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p AuthError (f AuthError) -&gt; p SomeException (f SomeException)
forall a. Exception a =&gt; Prism' SomeException a
</span><span class="hs-identifier hs-var">exception</span></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.AWS.Auth.html#AsAuthError"><span class="hs-identifier hs-type">AsAuthError</span></a></span><span> </span><span class="annot"><a href="Network.AWS.Auth.html#AuthError"><span class="hs-identifier hs-type">AuthError</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-344"></span><span>  </span><span id="local-6989586621679200664"><span class="annot"><span class="annottext">_AuthError :: p AuthError (f AuthError) -&gt; p AuthError (f AuthError)
</span><a href="#local-6989586621679200664"><span class="hs-identifier hs-var hs-var hs-var hs-var">_AuthError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p AuthError (f AuthError) -&gt; p AuthError (f AuthError)
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span>  </span><span id="local-6989586621679200662"><span class="annot"><span class="annottext">_RetrievalError :: p HttpException (f HttpException) -&gt; p AuthError (f AuthError)
</span><a href="#local-6989586621679200662"><span class="hs-identifier hs-var hs-var hs-var hs-var">_RetrievalError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HttpException -&gt; AuthError)
-&gt; (AuthError -&gt; Either AuthError HttpException)
-&gt; Prism' AuthError HttpException
forall b t s a. (b -&gt; t) -&gt; (s -&gt; Either t a) -&gt; Prism s t a b
</span><span class="hs-identifier hs-var">prism</span></span><span> </span><span class="annot"><span class="annottext">HttpException -&gt; AuthError
</span><a href="Network.AWS.Auth.html#RetrievalError"><span class="hs-identifier hs-var">RetrievalError</span></a></span><span> </span><span class="annot"><span class="annottext">((AuthError -&gt; Either AuthError HttpException)
 -&gt; Prism' AuthError HttpException)
-&gt; (AuthError -&gt; Either AuthError HttpException)
-&gt; Prism' AuthError HttpException
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#RetrievalError"><span class="hs-identifier hs-type">RetrievalError</span></a></span><span> </span><span id="local-6989586621679200661"><span class="annot"><span class="annottext">HttpException
</span><a href="#local-6989586621679200661"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HttpException -&gt; Either AuthError HttpException
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">HttpException
</span><a href="#local-6989586621679200661"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span id="local-6989586621679200660"><span class="annot"><span class="annottext">AuthError
</span><a href="#local-6989586621679200660"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AuthError -&gt; Either AuthError HttpException
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">AuthError
</span><a href="#local-6989586621679200660"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span>  </span><span id="local-6989586621679200659"><span class="annot"><span class="annottext">_MissingEnvError :: p Text (f Text) -&gt; p AuthError (f AuthError)
</span><a href="#local-6989586621679200659"><span class="hs-identifier hs-var hs-var hs-var hs-var">_MissingEnvError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; AuthError)
-&gt; (AuthError -&gt; Either AuthError Text) -&gt; Prism' AuthError Text
forall b t s a. (b -&gt; t) -&gt; (s -&gt; Either t a) -&gt; Prism s t a b
</span><span class="hs-identifier hs-var">prism</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; AuthError
</span><a href="Network.AWS.Auth.html#MissingEnvError"><span class="hs-identifier hs-var">MissingEnvError</span></a></span><span> </span><span class="annot"><span class="annottext">((AuthError -&gt; Either AuthError Text) -&gt; Prism' AuthError Text)
-&gt; (AuthError -&gt; Either AuthError Text) -&gt; Prism' AuthError Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-351"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#MissingEnvError"><span class="hs-identifier hs-type">MissingEnvError</span></a></span><span> </span><span id="local-6989586621679200658"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200658"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either AuthError Text
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200658"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-352"></span><span>    </span><span id="local-6989586621679200657"><span class="annot"><span class="annottext">AuthError
</span><a href="#local-6989586621679200657"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AuthError -&gt; Either AuthError Text
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">AuthError
</span><a href="#local-6989586621679200657"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span>  </span><span id="local-6989586621679200656"><span class="annot"><span class="annottext">_InvalidEnvError :: p Text (f Text) -&gt; p AuthError (f AuthError)
</span><a href="#local-6989586621679200656"><span class="hs-identifier hs-var hs-var hs-var hs-var">_InvalidEnvError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; AuthError)
-&gt; (AuthError -&gt; Either AuthError Text) -&gt; Prism' AuthError Text
forall b t s a. (b -&gt; t) -&gt; (s -&gt; Either t a) -&gt; Prism s t a b
</span><span class="hs-identifier hs-var">prism</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; AuthError
</span><a href="Network.AWS.Auth.html#InvalidEnvError"><span class="hs-identifier hs-var">InvalidEnvError</span></a></span><span> </span><span class="annot"><span class="annottext">((AuthError -&gt; Either AuthError Text) -&gt; Prism' AuthError Text)
-&gt; (AuthError -&gt; Either AuthError Text) -&gt; Prism' AuthError Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-355"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#InvalidEnvError"><span class="hs-identifier hs-type">InvalidEnvError</span></a></span><span> </span><span id="local-6989586621679200655"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200655"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either AuthError Text
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200655"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-356"></span><span>    </span><span id="local-6989586621679200654"><span class="annot"><span class="annottext">AuthError
</span><a href="#local-6989586621679200654"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AuthError -&gt; Either AuthError Text
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">AuthError
</span><a href="#local-6989586621679200654"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span>  </span><span id="local-6989586621679200653"><span class="annot"><span class="annottext">_MissingFileError :: p FilePath (f FilePath) -&gt; p AuthError (f AuthError)
</span><a href="#local-6989586621679200653"><span class="hs-identifier hs-var hs-var hs-var hs-var">_MissingFileError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; AuthError)
-&gt; (AuthError -&gt; Either AuthError FilePath)
-&gt; Prism' AuthError FilePath
forall b t s a. (b -&gt; t) -&gt; (s -&gt; Either t a) -&gt; Prism s t a b
</span><span class="hs-identifier hs-var">prism</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; AuthError
</span><a href="Network.AWS.Auth.html#MissingFileError"><span class="hs-identifier hs-var">MissingFileError</span></a></span><span> </span><span class="annot"><span class="annottext">((AuthError -&gt; Either AuthError FilePath)
 -&gt; Prism' AuthError FilePath)
-&gt; (AuthError -&gt; Either AuthError FilePath)
-&gt; Prism' AuthError FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#MissingFileError"><span class="hs-identifier hs-type">MissingFileError</span></a></span><span> </span><span id="local-6989586621679200652"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200652"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Either AuthError FilePath
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200652"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-360"></span><span>    </span><span id="local-6989586621679200651"><span class="annot"><span class="annottext">AuthError
</span><a href="#local-6989586621679200651"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AuthError -&gt; Either AuthError FilePath
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">AuthError
</span><a href="#local-6989586621679200651"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span>  </span><span id="local-6989586621679200650"><span class="annot"><span class="annottext">_InvalidFileError :: p Text (f Text) -&gt; p AuthError (f AuthError)
</span><a href="#local-6989586621679200650"><span class="hs-identifier hs-var hs-var hs-var hs-var">_InvalidFileError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; AuthError)
-&gt; (AuthError -&gt; Either AuthError Text) -&gt; Prism' AuthError Text
forall b t s a. (b -&gt; t) -&gt; (s -&gt; Either t a) -&gt; Prism s t a b
</span><span class="hs-identifier hs-var">prism</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; AuthError
</span><a href="Network.AWS.Auth.html#InvalidFileError"><span class="hs-identifier hs-var">InvalidFileError</span></a></span><span> </span><span class="annot"><span class="annottext">((AuthError -&gt; Either AuthError Text) -&gt; Prism' AuthError Text)
-&gt; (AuthError -&gt; Either AuthError Text) -&gt; Prism' AuthError Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-363"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#InvalidFileError"><span class="hs-identifier hs-type">InvalidFileError</span></a></span><span> </span><span id="local-6989586621679200649"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200649"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either AuthError Text
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200649"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-364"></span><span>    </span><span id="local-6989586621679200648"><span class="annot"><span class="annottext">AuthError
</span><a href="#local-6989586621679200648"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AuthError -&gt; Either AuthError Text
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">AuthError
</span><a href="#local-6989586621679200648"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span>  </span><span id="local-6989586621679200647"><span class="annot"><span class="annottext">_InvalidIAMError :: p Text (f Text) -&gt; p AuthError (f AuthError)
</span><a href="#local-6989586621679200647"><span class="hs-identifier hs-var hs-var hs-var hs-var">_InvalidIAMError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; AuthError)
-&gt; (AuthError -&gt; Either AuthError Text) -&gt; Prism' AuthError Text
forall b t s a. (b -&gt; t) -&gt; (s -&gt; Either t a) -&gt; Prism s t a b
</span><span class="hs-identifier hs-var">prism</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; AuthError
</span><a href="Network.AWS.Auth.html#InvalidIAMError"><span class="hs-identifier hs-var">InvalidIAMError</span></a></span><span> </span><span class="annot"><span class="annottext">((AuthError -&gt; Either AuthError Text) -&gt; Prism' AuthError Text)
-&gt; (AuthError -&gt; Either AuthError Text) -&gt; Prism' AuthError Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#InvalidIAMError"><span class="hs-identifier hs-type">InvalidIAMError</span></a></span><span> </span><span id="local-6989586621679200646"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200646"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either AuthError Text
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200646"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-368"></span><span>    </span><span id="local-6989586621679200645"><span class="annot"><span class="annottext">AuthError
</span><a href="#local-6989586621679200645"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AuthError -&gt; Either AuthError Text
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">AuthError
</span><a href="#local-6989586621679200645"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="hs-comment">-- | Retrieve authentication information via the specified 'Credentials' mechanism.</span><span>
</span><span id="line-371"></span><span class="hs-comment">--</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- Throws 'AuthError' when environment variables or IAM profiles cannot be read,</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- and credentials files are invalid or cannot be found.</span><span>
</span><span id="line-374"></span><span id="local-6989586621679200644"><span class="annot"><a href="Network.AWS.Auth.html#getAuth"><span class="hs-identifier hs-type">getAuth</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-375"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679200644"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-376"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Client.Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-377"></span><span>  </span><span class="annot"><a href="Network.AWS.Auth.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-378"></span><span>  </span><span class="annot"><a href="#local-6989586621679200644"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-type">Auth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#Region"><span class="hs-identifier hs-type">Region</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-379"></span><span id="getAuth"><span class="annot"><span class="annottext">getAuth :: Manager -&gt; Credentials -&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#getAuth"><span class="hs-identifier hs-var hs-var">getAuth</span></a></span></span><span> </span><span id="local-6989586621679200643"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679200643"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-380"></span><span>  </span><span class="annot"><span class="annottext">IO (Auth, Maybe Region) -&gt; m (Auth, Maybe Region)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Auth, Maybe Region) -&gt; m (Auth, Maybe Region))
-&gt; (Credentials -&gt; IO (Auth, Maybe Region))
-&gt; Credentials
-&gt; m (Auth, Maybe Region)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-381"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#FromKeys"><span class="hs-identifier hs-type">FromKeys</span></a></span><span> </span><span id="local-6989586621679200642"><span class="annot"><span class="annottext">AccessKey
</span><a href="#local-6989586621679200642"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679200641"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679200641"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Auth, Maybe Region) -&gt; IO (Auth, Maybe Region)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AccessKey -&gt; SecretKey -&gt; Auth
</span><a href="Network.AWS.Auth.html#fromKeys"><span class="hs-identifier hs-var">fromKeys</span></a></span><span> </span><span class="annot"><span class="annottext">AccessKey
</span><a href="#local-6989586621679200642"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679200641"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Region
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#FromSession"><span class="hs-identifier hs-type">FromSession</span></a></span><span> </span><span id="local-6989586621679200640"><span class="annot"><span class="annottext">AccessKey
</span><a href="#local-6989586621679200640"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679200639"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679200639"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679200638"><span class="annot"><span class="annottext">SessionToken
</span><a href="#local-6989586621679200638"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Auth, Maybe Region) -&gt; IO (Auth, Maybe Region)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AccessKey -&gt; SecretKey -&gt; SessionToken -&gt; Auth
</span><a href="Network.AWS.Auth.html#fromSession"><span class="hs-identifier hs-var">fromSession</span></a></span><span> </span><span class="annot"><span class="annottext">AccessKey
</span><a href="#local-6989586621679200640"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679200639"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">SessionToken
</span><a href="#local-6989586621679200638"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Region
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#FromEnv"><span class="hs-identifier hs-type">FromEnv</span></a></span><span> </span><span id="local-6989586621679200637"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200637"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679200636"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200636"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679200635"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679200635"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679200634"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679200634"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe Text -&gt; Maybe Text -&gt; IO (Auth, Maybe Region)
forall (m :: * -&gt; *).
MonadIO m =&gt;
Text -&gt; Text -&gt; Maybe Text -&gt; Maybe Text -&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromEnvKeys"><span class="hs-identifier hs-var">fromEnvKeys</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200637"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200636"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679200635"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679200634"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#FromProfile"><span class="hs-identifier hs-type">FromProfile</span></a></span><span> </span><span id="local-6989586621679200633"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200633"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Manager -&gt; Text -&gt; IO (Auth, Maybe Region)
forall (m :: * -&gt; *).
MonadIO m =&gt;
Manager -&gt; Text -&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromProfileName"><span class="hs-identifier hs-var">fromProfileName</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679200643"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200633"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><a href="Network.AWS.Auth.html#FromFile"><span class="hs-identifier hs-type">FromFile</span></a></span><span> </span><span id="local-6989586621679200632"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200632"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679200631"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200631"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span id="local-6989586621679200630"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200630"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath -&gt; FilePath -&gt; IO (Auth, Maybe Region)
forall (m :: * -&gt; *).
MonadIO m =&gt;
Text -&gt; FilePath -&gt; FilePath -&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromFilePath"><span class="hs-identifier hs-var">fromFilePath</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200632"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200631"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200630"><span class="hs-identifier hs-var">conf</span></a></span><span>
</span><span id="line-386"></span><span>    </span><span class="annot"><span class="annottext">Credentials
</span><a href="Network.AWS.Auth.html#FromContainer"><span class="hs-identifier hs-var">FromContainer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Manager -&gt; IO (Auth, Maybe Region)
forall (m :: * -&gt; *).
MonadIO m =&gt;
Manager -&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromContainer"><span class="hs-identifier hs-var">fromContainer</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679200643"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-387"></span><span>    </span><span class="annot"><span class="annottext">Credentials
</span><a href="Network.AWS.Auth.html#Discover"><span class="hs-identifier hs-var">Discover</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-388"></span><span>      </span><span class="hs-comment">-- Don't try and catch InvalidFileError, or InvalidIAMProfile,</span><span>
</span><span id="line-389"></span><span>      </span><span class="hs-comment">-- let both errors propagate.</span><span>
</span><span id="line-390"></span><span>      </span><span class="annot"><span class="annottext">Getting (First Text) SomeException Text
-&gt; IO (Auth, Maybe Region)
-&gt; IO (Auth, Maybe Region)
-&gt; IO (Auth, Maybe Region)
forall (m :: * -&gt; *) a r.
MonadCatch m =&gt;
Getting (First a) SomeException a -&gt; m r -&gt; m r -&gt; m r
</span><span class="hs-identifier hs-var">catching_</span></span><span> </span><span class="annot"><span class="annottext">Getting (First Text) SomeException Text
forall a. AsAuthError a =&gt; Prism' a Text
</span><a href="Network.AWS.Auth.html#_MissingEnvError"><span class="hs-identifier hs-var">_MissingEnvError</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Auth, Maybe Region)
forall (m :: * -&gt; *). MonadIO m =&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromEnv"><span class="hs-identifier hs-var">fromEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Auth, Maybe Region) -&gt; IO (Auth, Maybe Region))
-&gt; IO (Auth, Maybe Region) -&gt; IO (Auth, Maybe Region)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-391"></span><span>        </span><span class="hs-comment">-- proceed, missing env keys</span><span>
</span><span id="line-392"></span><span>        </span><span class="annot"><span class="annottext">Getting (First FilePath) SomeException FilePath
-&gt; IO (Auth, Maybe Region)
-&gt; (FilePath -&gt; IO (Auth, Maybe Region))
-&gt; IO (Auth, Maybe Region)
forall (m :: * -&gt; *) a r.
MonadCatch m =&gt;
Getting (First a) SomeException a -&gt; m r -&gt; (a -&gt; m r) -&gt; m r
</span><span class="hs-identifier hs-var">catching</span></span><span> </span><span class="annot"><span class="annottext">Getting (First FilePath) SomeException FilePath
forall a. AsAuthError a =&gt; Prism' a FilePath
</span><a href="Network.AWS.Auth.html#_MissingFileError"><span class="hs-identifier hs-var">_MissingFileError</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Auth, Maybe Region)
forall (m :: * -&gt; *). MonadIO m =&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromFile"><span class="hs-identifier hs-var">fromFile</span></a></span><span> </span><span class="annot"><span class="annottext">((FilePath -&gt; IO (Auth, Maybe Region)) -&gt; IO (Auth, Maybe Region))
-&gt; (FilePath -&gt; IO (Auth, Maybe Region)) -&gt; IO (Auth, Maybe Region)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679200629"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200629"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-393"></span><span>          </span><span class="hs-comment">-- proceed, missing credentials file</span><span>
</span><span id="line-394"></span><span>          </span><span class="annot"><span class="annottext">Getting (First Text) SomeException Text
-&gt; IO (Auth, Maybe Region)
-&gt; IO (Auth, Maybe Region)
-&gt; IO (Auth, Maybe Region)
forall (m :: * -&gt; *) a r.
MonadCatch m =&gt;
Getting (First a) SomeException a -&gt; m r -&gt; m r -&gt; m r
</span><span class="hs-identifier hs-var">catching_</span></span><span> </span><span class="annot"><span class="annottext">Getting (First Text) SomeException Text
forall a. AsAuthError a =&gt; Prism' a Text
</span><a href="Network.AWS.Auth.html#_MissingEnvError"><span class="hs-identifier hs-var">_MissingEnvError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Manager -&gt; IO (Auth, Maybe Region)
forall (m :: * -&gt; *).
MonadIO m =&gt;
Manager -&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromContainer"><span class="hs-identifier hs-var">fromContainer</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679200643"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO (Auth, Maybe Region) -&gt; IO (Auth, Maybe Region))
-&gt; IO (Auth, Maybe Region) -&gt; IO (Auth, Maybe Region)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-395"></span><span>            </span><span class="hs-comment">-- proceed, missing env key</span><span>
</span><span id="line-396"></span><span>            </span><span id="local-6989586621679200628"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679200628"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Manager -&gt; IO Bool
forall (m :: * -&gt; *). MonadIO m =&gt; Manager -&gt; m Bool
</span><a href="Network.AWS.EC2.Metadata.html#isEC2"><span class="hs-identifier hs-var">isEC2</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679200643"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679200628"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-399"></span><span>              </span><span class="hs-comment">-- not an EC2 instance, rethrow the previous error.</span><span>
</span><span id="line-400"></span><span>              </span><span class="annot"><span class="annottext">AReview SomeException FilePath -&gt; FilePath -&gt; IO ()
forall (m :: * -&gt; *) b r.
MonadThrow m =&gt;
AReview SomeException b -&gt; b -&gt; m r
</span><span class="hs-identifier hs-var">throwingM</span></span><span> </span><span class="annot"><span class="annottext">AReview SomeException FilePath
forall a. AsAuthError a =&gt; Prism' a FilePath
</span><a href="Network.AWS.Auth.html#_MissingFileError"><span class="hs-identifier hs-var">_MissingFileError</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200629"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span>            </span><span class="hs-comment">-- proceed, check EC2 metadata for IAM information.</span><span>
</span><span id="line-403"></span><span>            </span><span class="annot"><span class="annottext">Manager -&gt; IO (Auth, Maybe Region)
forall (m :: * -&gt; *).
MonadIO m =&gt;
Manager -&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromProfile"><span class="hs-identifier hs-var">fromProfile</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679200643"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="hs-comment">-- | Retrieve access key, secret key, and a session token from the default</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- environment variables.</span><span>
</span><span id="line-407"></span><span class="hs-comment">--</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- Throws 'MissingEnvError' if either of the default environment variables</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- cannot be read, but not if the session token is absent.</span><span>
</span><span id="line-410"></span><span class="hs-comment">--</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- /See:/ 'envAccessKey', 'envSecretKey', 'envSessionToken'</span><span>
</span><span id="line-412"></span><span id="local-6989586621679200912"><span class="annot"><a href="Network.AWS.Auth.html#fromEnv"><span class="hs-identifier hs-type">fromEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679200912"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679200912"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-type">Auth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#Region"><span class="hs-identifier hs-type">Region</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-413"></span><span id="fromEnv"><span class="annot"><span class="annottext">fromEnv :: m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromEnv"><span class="hs-identifier hs-var hs-var">fromEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-414"></span><span>  </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe Text -&gt; Maybe Text -&gt; m (Auth, Maybe Region)
forall (m :: * -&gt; *).
MonadIO m =&gt;
Text -&gt; Text -&gt; Maybe Text -&gt; Maybe Text -&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromEnvKeys"><span class="hs-identifier hs-var">fromEnvKeys</span></a></span><span>
</span><span id="line-415"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><a href="Network.AWS.Auth.html#envAccessKey"><span class="hs-identifier hs-var">envAccessKey</span></a></span><span>
</span><span id="line-416"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><a href="Network.AWS.Auth.html#envSecretKey"><span class="hs-identifier hs-var">envSecretKey</span></a></span><span>
</span><span id="line-417"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Network.AWS.Auth.html#envSessionToken"><span class="hs-identifier hs-var">envSessionToken</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Network.AWS.Auth.html#envRegion"><span class="hs-identifier hs-var">envRegion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="hs-comment">-- | Retrieve access key, secret key and a session token from specific</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- environment variables.</span><span>
</span><span id="line-422"></span><span class="hs-comment">--</span><span>
</span><span id="line-423"></span><span class="hs-comment">-- Throws 'MissingEnvError' if either of the specified key environment variables</span><span>
</span><span id="line-424"></span><span class="hs-comment">-- cannot be read, but not if the session token is absent.</span><span>
</span><span id="line-425"></span><span id="local-6989586621679200916"><span class="annot"><a href="Network.AWS.Auth.html#fromEnvKeys"><span class="hs-identifier hs-type">fromEnvKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-426"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679200916"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-comment">-- | Access key environment variable.</span><span>
</span><span id="line-428"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-comment">-- | Secret key environment variable.</span><span>
</span><span id="line-430"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-431"></span><span>  </span><span class="hs-comment">-- | Session token environment variable.</span><span>
</span><span id="line-432"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-comment">-- | Region environment variable.</span><span>
</span><span id="line-434"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-435"></span><span>  </span><span class="annot"><a href="#local-6989586621679200916"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-type">Auth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#Region"><span class="hs-identifier hs-type">Region</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-436"></span><span id="fromEnvKeys"><span class="annot"><span class="annottext">fromEnvKeys :: Text -&gt; Text -&gt; Maybe Text -&gt; Maybe Text -&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromEnvKeys"><span class="hs-identifier hs-var hs-var">fromEnvKeys</span></a></span></span><span> </span><span id="local-6989586621679200625"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200625"><span class="hs-identifier hs-var">access</span></a></span></span><span> </span><span id="local-6989586621679200624"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200624"><span class="hs-identifier hs-var">secret</span></a></span></span><span> </span><span id="local-6989586621679200623"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679200623"><span class="hs-identifier hs-var">session</span></a></span></span><span> </span><span id="local-6989586621679200622"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679200622"><span class="hs-identifier hs-var">region'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-437"></span><span>  </span><span class="annot"><span class="annottext">IO (Auth, Maybe Region) -&gt; m (Auth, Maybe Region)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Auth, Maybe Region) -&gt; m (Auth, Maybe Region))
-&gt; IO (Auth, Maybe Region) -&gt; m (Auth, Maybe Region)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Auth -&gt; Maybe Region -&gt; (Auth, Maybe Region))
-&gt; IO Auth -&gt; IO (Maybe Region -&gt; (Auth, Maybe Region))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(AuthEnv -&gt; Auth) -&gt; IO AuthEnv -&gt; IO Auth
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">AuthEnv -&gt; Auth
</span><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-var">Auth</span></a></span><span> </span><span class="annot"><span class="annottext">IO AuthEnv
</span><a href="#local-6989586621679200621"><span class="hs-identifier hs-var">lookupKeys</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe Region -&gt; (Auth, Maybe Region))
-&gt; IO (Maybe Region) -&gt; IO (Auth, Maybe Region)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO (Maybe Region)
</span><a href="#local-6989586621679200620"><span class="hs-identifier hs-var">lookupRegion</span></a></span><span>
</span><span id="line-438"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-439"></span><span>    </span><span id="local-6989586621679200621"><span class="annot"><span class="annottext">lookupKeys :: IO AuthEnv
</span><a href="#local-6989586621679200621"><span class="hs-identifier hs-var hs-var">lookupKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-440"></span><span>      </span><span class="annot"><span class="annottext">AccessKey
-&gt; Sensitive SecretKey
-&gt; Maybe (Sensitive SessionToken)
-&gt; Maybe ISO8601
-&gt; AuthEnv
</span><a href="Network.AWS.Types.html#AuthEnv"><span class="hs-identifier hs-var">AuthEnv</span></a></span><span>
</span><span id="line-441"></span><span>        </span><span class="annot"><span class="annottext">(AccessKey
 -&gt; Sensitive SecretKey
 -&gt; Maybe (Sensitive SessionToken)
 -&gt; Maybe ISO8601
 -&gt; AuthEnv)
-&gt; IO AccessKey
-&gt; IO
     (Sensitive SecretKey
      -&gt; Maybe (Sensitive SessionToken) -&gt; Maybe ISO8601 -&gt; AuthEnv)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; IO FilePath
</span><a href="#local-6989586621679200619"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200625"><span class="hs-identifier hs-var">access</span></a></span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; (FilePath -&gt; AccessKey) -&gt; IO AccessKey
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; AccessKey
</span><a href="Network.AWS.Types.html#AccessKey"><span class="hs-identifier hs-var">AccessKey</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; AccessKey)
-&gt; (FilePath -&gt; ByteString) -&gt; FilePath -&gt; AccessKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString
</span><span class="hs-identifier hs-var">BS8.pack</span></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>        </span><span class="annot"><span class="annottext">IO
  (Sensitive SecretKey
   -&gt; Maybe (Sensitive SessionToken) -&gt; Maybe ISO8601 -&gt; AuthEnv)
-&gt; IO (Sensitive SecretKey)
-&gt; IO (Maybe (Sensitive SessionToken) -&gt; Maybe ISO8601 -&gt; AuthEnv)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; IO FilePath
</span><a href="#local-6989586621679200619"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200624"><span class="hs-identifier hs-var">secret</span></a></span><span> </span><span class="annot"><span class="annottext">IO FilePath
-&gt; (FilePath -&gt; Sensitive SecretKey) -&gt; IO (Sensitive SecretKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; Sensitive SecretKey
forall a. a -&gt; Sensitive a
</span><a href="Network.AWS.Data.Sensitive.html#Sensitive"><span class="hs-identifier hs-var">Sensitive</span></a></span><span> </span><span class="annot"><span class="annottext">(SecretKey -&gt; Sensitive SecretKey)
-&gt; (FilePath -&gt; SecretKey) -&gt; FilePath -&gt; Sensitive SecretKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; SecretKey
</span><a href="Network.AWS.Types.html#SecretKey"><span class="hs-identifier hs-var">SecretKey</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; SecretKey)
-&gt; (FilePath -&gt; ByteString) -&gt; FilePath -&gt; SecretKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString
</span><span class="hs-identifier hs-var">BS8.pack</span></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>        </span><span class="annot"><span class="annottext">IO (Maybe (Sensitive SessionToken) -&gt; Maybe ISO8601 -&gt; AuthEnv)
-&gt; IO (Maybe (Sensitive SessionToken))
-&gt; IO (Maybe ISO8601 -&gt; AuthEnv)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; IO (Maybe FilePath)
</span><a href="#local-6989586621679200614"><span class="hs-identifier hs-var">opt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679200623"><span class="hs-identifier hs-var">session</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe FilePath)
-&gt; (Maybe FilePath -&gt; Maybe (Sensitive SessionToken))
-&gt; IO (Maybe (Sensitive SessionToken))
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Sensitive SessionToken)
-&gt; Maybe FilePath -&gt; Maybe (Sensitive SessionToken)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SessionToken -&gt; Sensitive SessionToken
forall a. a -&gt; Sensitive a
</span><a href="Network.AWS.Data.Sensitive.html#Sensitive"><span class="hs-identifier hs-var">Sensitive</span></a></span><span> </span><span class="annot"><span class="annottext">(SessionToken -&gt; Sensitive SessionToken)
-&gt; (FilePath -&gt; SessionToken) -&gt; FilePath -&gt; Sensitive SessionToken
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; SessionToken
</span><a href="Network.AWS.Types.html#SessionToken"><span class="hs-identifier hs-var">SessionToken</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; SessionToken)
-&gt; (FilePath -&gt; ByteString) -&gt; FilePath -&gt; SessionToken
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString
</span><span class="hs-identifier hs-var">BS8.pack</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>        </span><span class="annot"><span class="annottext">IO (Maybe ISO8601 -&gt; AuthEnv) -&gt; IO (Maybe ISO8601) -&gt; IO AuthEnv
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe ISO8601 -&gt; IO (Maybe ISO8601)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe ISO8601
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span>    </span><span id="local-6989586621679200620"><span class="annot"><span class="annottext">lookupRegion :: IO (Maybe Region)
</span><a href="#local-6989586621679200620"><span class="hs-identifier hs-var hs-var">lookupRegion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; IO (Maybe FilePath)
</span><a href="#local-6989586621679200614"><span class="hs-identifier hs-var">opt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679200622"><span class="hs-identifier hs-var">region'</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe FilePath)
-&gt; (Maybe FilePath -&gt; Maybe Region) -&gt; IO (Maybe Region)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Region) -&gt; Maybe FilePath -&gt; Maybe Region
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Region
</span><a href="Network.AWS.Types.html#Region%27"><span class="hs-identifier hs-var">Region'</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Region) -&gt; (FilePath -&gt; Text) -&gt; FilePath -&gt; Region
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span>    </span><span id="local-6989586621679200619"><span class="annot"><span class="annottext">req :: Text -&gt; IO FilePath
</span><a href="#local-6989586621679200619"><span class="hs-identifier hs-var hs-var">req</span></a></span></span><span> </span><span id="local-6989586621679200610"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200610"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-449"></span><span>      </span><span id="local-6989586621679200609"><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679200609"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; IO (Maybe FilePath)
</span><a href="#local-6989586621679200614"><span class="hs-identifier hs-var">opt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200610"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>      </span><span class="annot"><span class="annottext">IO FilePath
-&gt; (FilePath -&gt; IO FilePath) -&gt; Maybe FilePath -&gt; IO FilePath
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span>
</span><span id="line-451"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthError -&gt; IO FilePath
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">Exception.throwIO</span></span><span> </span><span class="annot"><span class="annottext">(AuthError -&gt; IO FilePath)
-&gt; (Text -&gt; AuthError) -&gt; Text -&gt; IO FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; AuthError
</span><a href="Network.AWS.Auth.html#MissingEnvError"><span class="hs-identifier hs-var">MissingEnvError</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO FilePath) -&gt; Text -&gt; IO FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Unable to read ENV variable: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200610"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-453"></span><span>        </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679200609"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span>    </span><span id="local-6989586621679200614"><span class="annot"><span class="annottext">opt :: Maybe Text -&gt; IO (Maybe FilePath)
</span><a href="#local-6989586621679200614"><span class="hs-identifier hs-var hs-var">opt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-456"></span><span>      </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; IO (Maybe FilePath)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-457"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679200607"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200607"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Maybe FilePath)
</span><span class="hs-identifier hs-var">Environment.lookupEnv</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">Text.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200607"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="hs-comment">-- | Loads the default @credentials@ INI file using the default profile name.</span><span>
</span><span id="line-460"></span><span class="hs-comment">--</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- Throws 'MissingFileError' if 'credFile' is missing, or 'InvalidFileError'</span><span>
</span><span id="line-462"></span><span class="hs-comment">-- if an error occurs during parsing.</span><span>
</span><span id="line-463"></span><span class="hs-comment">--</span><span>
</span><span id="line-464"></span><span class="hs-comment">-- /See:/ 'credProfile', 'credFile', and 'envProfile'</span><span>
</span><span id="line-465"></span><span id="local-6989586621679200604"><span class="annot"><a href="Network.AWS.Auth.html#fromFile"><span class="hs-identifier hs-type">fromFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679200604"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679200604"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-type">Auth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#Region"><span class="hs-identifier hs-type">Region</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-466"></span><span id="fromFile"><span class="annot"><span class="annottext">fromFile :: m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromFile"><span class="hs-identifier hs-var hs-var">fromFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-467"></span><span>  </span><span id="local-6989586621679200603"><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679200603"><span class="hs-identifier hs-var">mprofile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe FilePath) -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO (Maybe FilePath)
</span><span class="hs-identifier hs-var">Environment.lookupEnv</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">Text.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Network.AWS.Auth.html#envProfile"><span class="hs-identifier hs-var">envProfile</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>  </span><span id="local-6989586621679200602"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200602"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m FilePath
forall (m :: * -&gt; *). MonadIO m =&gt; m FilePath
</span><a href="Network.AWS.Auth.html#credFile"><span class="hs-identifier hs-var">credFile</span></a></span><span>
</span><span id="line-469"></span><span>  </span><span id="local-6989586621679200601"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200601"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m FilePath
forall (m :: * -&gt; *). MonadIO m =&gt; m FilePath
</span><a href="Network.AWS.Auth.html#confFile"><span class="hs-identifier hs-var">confFile</span></a></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span>  </span><span class="annot"><span class="annottext">Text -&gt; FilePath -&gt; FilePath -&gt; m (Auth, Maybe Region)
forall (m :: * -&gt; *).
MonadIO m =&gt;
Text -&gt; FilePath -&gt; FilePath -&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromFilePath"><span class="hs-identifier hs-var">fromFilePath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; (FilePath -&gt; Text) -&gt; Maybe FilePath -&gt; Text
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Network.AWS.Auth.html#credProfile"><span class="hs-identifier hs-var">credProfile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679200603"><span class="hs-identifier hs-var">mprofile</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200602"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200601"><span class="hs-identifier hs-var">conf</span></a></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span id="local-6989586621679200914"><span class="annot"><a href="Network.AWS.Auth.html#fromFilePath"><span class="hs-identifier hs-type">fromFilePath</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-474"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679200914"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-475"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-476"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-477"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-478"></span><span>  </span><span class="annot"><a href="#local-6989586621679200914"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-type">Auth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#Region"><span class="hs-identifier hs-type">Region</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-479"></span><span id="fromFilePath"><span class="annot"><span class="annottext">fromFilePath :: Text -&gt; FilePath -&gt; FilePath -&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromFilePath"><span class="hs-identifier hs-var hs-var">fromFilePath</span></a></span></span><span> </span><span id="local-6989586621679200600"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200600"><span class="hs-identifier hs-var">profile</span></a></span></span><span> </span><span id="local-6989586621679200599"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200599"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span id="local-6989586621679200598"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200598"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-480"></span><span>  </span><span class="annot"><span class="annottext">IO (Auth, Maybe Region) -&gt; m (Auth, Maybe Region)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Auth -&gt; Maybe Region -&gt; (Auth, Maybe Region))
-&gt; IO Auth -&gt; IO (Maybe Region -&gt; (Auth, Maybe Region))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Auth
</span><a href="#local-6989586621679200597"><span class="hs-identifier hs-var">lookupCredentials</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200599"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe Region -&gt; (Auth, Maybe Region))
-&gt; IO (Maybe Region) -&gt; IO (Auth, Maybe Region)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Maybe Region)
</span><a href="#local-6989586621679200596"><span class="hs-identifier hs-var">lookupRegion</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200598"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-482"></span><span>    </span><span id="local-6989586621679200597"><span class="annot"><span class="annottext">lookupCredentials :: FilePath -&gt; IO Auth
</span><a href="#local-6989586621679200597"><span class="hs-identifier hs-var hs-var">lookupCredentials</span></a></span></span><span> </span><span id="local-6989586621679200595"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200595"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-483"></span><span>      </span><span id="local-6989586621679200594"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679200594"><span class="hs-identifier hs-var">exists</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><span class="hs-identifier hs-var">Directory.doesFileExist</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200595"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679200594"><span class="hs-identifier hs-var">exists</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-486"></span><span>        </span><span class="annot"><span class="annottext">AuthError -&gt; IO ()
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">Exception.throwIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; AuthError
</span><a href="Network.AWS.Auth.html#MissingFileError"><span class="hs-identifier hs-var">MissingFileError</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200595"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span>      </span><span id="local-6989586621679200592"><span class="annot"><span class="annottext">Ini
</span><a href="#local-6989586621679200592"><span class="hs-identifier hs-var">ini</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Either FilePath Ini)
</span><span class="hs-identifier hs-var">INI.readIniFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200595"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either FilePath Ini)
-&gt; (Either FilePath Ini -&gt; IO Ini) -&gt; IO Ini
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO Ini)
-&gt; (Ini -&gt; IO Ini) -&gt; Either FilePath Ini -&gt; IO Ini
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Maybe Text -&gt; FilePath -&gt; IO Ini
forall a. FilePath -&gt; Maybe Text -&gt; FilePath -&gt; IO a
</span><a href="#local-6989586621679200589"><span class="hs-identifier hs-var">throwInvalid</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200595"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ini -&gt; IO Ini
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span>      </span><span id="local-6989586621679200588"><span class="annot"><span class="annottext">AuthEnv
</span><a href="#local-6989586621679200588"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-491"></span><span>        </span><span class="annot"><span class="annottext">AccessKey
-&gt; Sensitive SecretKey
-&gt; Maybe (Sensitive SessionToken)
-&gt; Maybe ISO8601
-&gt; AuthEnv
</span><a href="Network.AWS.Types.html#AuthEnv"><span class="hs-identifier hs-var">AuthEnv</span></a></span><span>
</span><span id="line-492"></span><span>          </span><span class="annot"><span class="annottext">(AccessKey
 -&gt; Sensitive SecretKey
 -&gt; Maybe (Sensitive SessionToken)
 -&gt; Maybe ISO8601
 -&gt; AuthEnv)
-&gt; IO AccessKey
-&gt; IO
     (Sensitive SecretKey
      -&gt; Maybe (Sensitive SessionToken) -&gt; Maybe ISO8601 -&gt; AuthEnv)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Text -&gt; Ini -&gt; IO ByteString
</span><a href="#local-6989586621679200587"><span class="hs-identifier hs-var">required</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200595"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Network.AWS.Auth.html#credAccessKey"><span class="hs-identifier hs-var">credAccessKey</span></a></span><span> </span><span class="annot"><span class="annottext">Ini
</span><a href="#local-6989586621679200592"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; (ByteString -&gt; AccessKey) -&gt; IO AccessKey
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; AccessKey
</span><a href="Network.AWS.Types.html#AccessKey"><span class="hs-identifier hs-var">AccessKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>          </span><span class="annot"><span class="annottext">IO
  (Sensitive SecretKey
   -&gt; Maybe (Sensitive SessionToken) -&gt; Maybe ISO8601 -&gt; AuthEnv)
-&gt; IO (Sensitive SecretKey)
-&gt; IO (Maybe (Sensitive SessionToken) -&gt; Maybe ISO8601 -&gt; AuthEnv)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Text -&gt; Ini -&gt; IO ByteString
</span><a href="#local-6989586621679200587"><span class="hs-identifier hs-var">required</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200595"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Network.AWS.Auth.html#credSecretKey"><span class="hs-identifier hs-var">credSecretKey</span></a></span><span> </span><span class="annot"><span class="annottext">Ini
</span><a href="#local-6989586621679200592"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="annot"><span class="annottext">IO ByteString
-&gt; (ByteString -&gt; Sensitive SecretKey) -&gt; IO (Sensitive SecretKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; Sensitive SecretKey
forall a. a -&gt; Sensitive a
</span><a href="Network.AWS.Data.Sensitive.html#Sensitive"><span class="hs-identifier hs-var">Sensitive</span></a></span><span> </span><span class="annot"><span class="annottext">(SecretKey -&gt; Sensitive SecretKey)
-&gt; (ByteString -&gt; SecretKey) -&gt; ByteString -&gt; Sensitive SecretKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; SecretKey
</span><a href="Network.AWS.Types.html#SecretKey"><span class="hs-identifier hs-var">SecretKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>          </span><span class="annot"><span class="annottext">IO (Maybe (Sensitive SessionToken) -&gt; Maybe ISO8601 -&gt; AuthEnv)
-&gt; IO (Maybe (Sensitive SessionToken))
-&gt; IO (Maybe ISO8601 -&gt; AuthEnv)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Ini -&gt; IO (Maybe ByteString)
</span><a href="#local-6989586621679200586"><span class="hs-identifier hs-var">optional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Network.AWS.Auth.html#credSessionToken"><span class="hs-identifier hs-var">credSessionToken</span></a></span><span> </span><span class="annot"><span class="annottext">Ini
</span><a href="#local-6989586621679200592"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe ByteString)
-&gt; (Maybe ByteString -&gt; Maybe (Sensitive SessionToken))
-&gt; IO (Maybe (Sensitive SessionToken))
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Sensitive SessionToken)
-&gt; Maybe ByteString -&gt; Maybe (Sensitive SessionToken)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SessionToken -&gt; Sensitive SessionToken
forall a. a -&gt; Sensitive a
</span><a href="Network.AWS.Data.Sensitive.html#Sensitive"><span class="hs-identifier hs-var">Sensitive</span></a></span><span> </span><span class="annot"><span class="annottext">(SessionToken -&gt; Sensitive SessionToken)
-&gt; (ByteString -&gt; SessionToken)
-&gt; ByteString
-&gt; Sensitive SessionToken
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; SessionToken
</span><a href="Network.AWS.Types.html#SessionToken"><span class="hs-identifier hs-var">SessionToken</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>          </span><span class="annot"><span class="annottext">IO (Maybe ISO8601 -&gt; AuthEnv) -&gt; IO (Maybe ISO8601) -&gt; IO AuthEnv
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe ISO8601 -&gt; IO (Maybe ISO8601)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe ISO8601
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span>      </span><span class="annot"><span class="annottext">Auth -&gt; IO Auth
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthEnv -&gt; Auth
</span><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-var">Auth</span></a></span><span> </span><span class="annot"><span class="annottext">AuthEnv
</span><a href="#local-6989586621679200588"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span>    </span><span id="local-6989586621679200596"><span class="annot"><span class="annottext">lookupRegion :: FilePath -&gt; IO (Maybe Region)
</span><a href="#local-6989586621679200596"><span class="hs-identifier hs-var hs-var">lookupRegion</span></a></span></span><span> </span><span id="local-6989586621679200585"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200585"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-500"></span><span>      </span><span id="local-6989586621679200584"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679200584"><span class="hs-identifier hs-var">exists</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><span class="hs-identifier hs-var">Directory.doesFileExist</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200585"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679200584"><span class="hs-identifier hs-var">exists</span></a></span><span>
</span><span id="line-503"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Region -&gt; IO (Maybe Region)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Region
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-504"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-505"></span><span>          </span><span id="local-6989586621679200582"><span class="annot"><span class="annottext">Ini
</span><a href="#local-6989586621679200582"><span class="hs-identifier hs-var">ini</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Either FilePath Ini)
</span><span class="hs-identifier hs-var">INI.readIniFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200585"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either FilePath Ini)
-&gt; (Either FilePath Ini -&gt; IO Ini) -&gt; IO Ini
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO Ini)
-&gt; (Ini -&gt; IO Ini) -&gt; Either FilePath Ini -&gt; IO Ini
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Maybe Text -&gt; FilePath -&gt; IO Ini
forall a. FilePath -&gt; Maybe Text -&gt; FilePath -&gt; IO a
</span><a href="#local-6989586621679200589"><span class="hs-identifier hs-var">throwInvalid</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200585"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ini -&gt; IO Ini
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679200581"><span class="annot"><span class="annottext">configProfile :: Text
</span><a href="#local-6989586621679200581"><span class="hs-identifier hs-var hs-var">configProfile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-508"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200600"><span class="hs-identifier hs-var">profile</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;default&quot;</span></span><span>
</span><span id="line-509"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200600"><span class="hs-identifier hs-var">profile</span></a></span><span>
</span><span id="line-510"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;profile &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200600"><span class="hs-identifier hs-var">profile</span></a></span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Ini -&gt; Either FilePath Text
</span><span class="hs-identifier hs-var">INI.lookupValue</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200581"><span class="hs-identifier hs-var">configProfile</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Network.AWS.Auth.html#confRegion"><span class="hs-identifier hs-var">confRegion</span></a></span><span> </span><span class="annot"><span class="annottext">Ini
</span><a href="#local-6989586621679200582"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-513"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Region -&gt; IO (Maybe Region)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Region
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-514"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679200579"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200579"><span class="hs-identifier hs-var">regionValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-515"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either FilePath Region
forall a. FromText a =&gt; Text -&gt; Either FilePath a
</span><a href="Network.AWS.Data.Text.html#fromText"><span class="hs-identifier hs-var">fromText</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200579"><span class="hs-identifier hs-var">regionValue</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-516"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679200577"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200577"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Region) -&gt; IO (Maybe Region)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Maybe Text -&gt; FilePath -&gt; IO (Maybe Region)
forall a. FilePath -&gt; Maybe Text -&gt; FilePath -&gt; IO a
</span><a href="#local-6989586621679200589"><span class="hs-identifier hs-var">throwInvalid</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200585"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Network.AWS.Auth.html#confRegion"><span class="hs-identifier hs-var">confRegion</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200577"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679200576"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621679200576"><span class="hs-identifier hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Region -&gt; IO (Maybe Region)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Region -&gt; Maybe Region
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621679200576"><span class="hs-identifier hs-var">ok</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span>    </span><span id="local-6989586621679200587"><span class="annot"><span class="annottext">required :: FilePath -&gt; Text -&gt; Ini -&gt; IO ByteString
</span><a href="#local-6989586621679200587"><span class="hs-identifier hs-var hs-var">required</span></a></span></span><span> </span><span id="local-6989586621679200575"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200575"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679200574"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200574"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679200573"><span class="annot"><span class="annottext">Ini
</span><a href="#local-6989586621679200573"><span class="hs-identifier hs-var">ini</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-520"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Ini -&gt; Either FilePath Text
</span><span class="hs-identifier hs-var">INI.lookupValue</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200600"><span class="hs-identifier hs-var">profile</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200574"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Ini
</span><a href="#local-6989586621679200573"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-521"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679200572"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200572"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe Text -&gt; FilePath -&gt; IO ByteString
forall a. FilePath -&gt; Maybe Text -&gt; FilePath -&gt; IO a
</span><a href="#local-6989586621679200589"><span class="hs-identifier hs-var">throwInvalid</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200575"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200574"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200572"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-522"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679200571"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200571"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-523"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><a href="#local-6989586621679200570"><span class="hs-identifier hs-var">blank</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200571"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe Text -&gt; FilePath -&gt; IO ByteString
forall a. FilePath -&gt; Maybe Text -&gt; FilePath -&gt; IO a
</span><a href="#local-6989586621679200589"><span class="hs-identifier hs-var">throwInvalid</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200575"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200574"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;cannot be a blank string.&quot;</span></span><span>
</span><span id="line-524"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">Text.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200571"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-526"></span><span>        </span><span id="local-6989586621679200570"><span class="annot"><span class="annottext">blank :: Text -&gt; Bool
</span><a href="#local-6989586621679200570"><span class="hs-identifier hs-var hs-var">blank</span></a></span></span><span> </span><span id="local-6989586621679200568"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200568"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">Text.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200568"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Bool
</span><span class="hs-identifier hs-var">Text.all</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">Char.isSpace</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200568"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span>    </span><span id="local-6989586621679200586"><span class="annot"><span class="annottext">optional :: Text -&gt; Ini -&gt; IO (Maybe ByteString)
</span><a href="#local-6989586621679200586"><span class="hs-identifier hs-var hs-var">optional</span></a></span></span><span> </span><span id="local-6989586621679200563"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200563"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679200562"><span class="annot"><span class="annottext">Ini
</span><a href="#local-6989586621679200562"><span class="hs-identifier hs-var">ini</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-529"></span><span>      </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; IO (Maybe ByteString)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; IO (Maybe ByteString))
-&gt; Maybe ByteString -&gt; IO (Maybe ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-530"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Ini -&gt; Either FilePath Text
</span><span class="hs-identifier hs-var">INI.lookupValue</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200600"><span class="hs-identifier hs-var">profile</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200563"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Ini
</span><a href="#local-6989586621679200562"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-531"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-532"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679200561"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200561"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">Text.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200561"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span>    </span><span id="local-6989586621679200878"><span class="annot"><a href="#local-6989586621679200589"><span class="hs-identifier hs-type">throwInvalid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679200878"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-535"></span><span>    </span><span id="local-6989586621679200589"><span class="annot"><span class="annottext">throwInvalid :: FilePath -&gt; Maybe Text -&gt; FilePath -&gt; IO a
</span><a href="#local-6989586621679200589"><span class="hs-identifier hs-var hs-var">throwInvalid</span></a></span></span><span> </span><span id="local-6989586621679200559"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200559"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679200558"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679200558"><span class="hs-identifier hs-var">mkey</span></a></span></span><span> </span><span id="local-6989586621679200557"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200557"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-536"></span><span>      </span><span class="annot"><span class="annottext">AuthError -&gt; IO a
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">Exception.throwIO</span></span><span> </span><span class="annot"><span class="annottext">(AuthError -&gt; IO a) -&gt; (Text -&gt; AuthError) -&gt; Text -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; AuthError
</span><a href="Network.AWS.Auth.html#InvalidFileError"><span class="hs-identifier hs-var">InvalidFileError</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO a) -&gt; Text -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-537"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200559"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-538"></span><span>          </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; (Text -&gt; Text) -&gt; Maybe Text -&gt; Text
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;, key &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679200558"><span class="hs-identifier hs-var">mkey</span></a></span><span>
</span><span id="line-539"></span><span>          </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;, &quot;</span></span><span>
</span><span id="line-540"></span><span>          </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200557"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span class="hs-comment">-- | Retrieve the default IAM Profile from the local EC2 instance-data.</span><span>
</span><span id="line-543"></span><span class="hs-comment">--</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- The default IAM profile is determined by Amazon as the first profile found</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- in the response from:</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- @http://169.254.169.254/latest/meta-data/iam/security-credentials/@</span><span>
</span><span id="line-547"></span><span class="hs-comment">--</span><span>
</span><span id="line-548"></span><span class="hs-comment">-- Throws 'RetrievalError' if the HTTP call fails, or 'InvalidIAMError' if</span><span>
</span><span id="line-549"></span><span class="hs-comment">-- the default IAM profile cannot be read.</span><span>
</span><span id="line-550"></span><span id="local-6989586621679200556"><span class="annot"><a href="Network.AWS.Auth.html#fromProfile"><span class="hs-identifier hs-type">fromProfile</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-551"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679200556"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-552"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Client.Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-553"></span><span>  </span><span class="annot"><a href="#local-6989586621679200556"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-type">Auth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#Region"><span class="hs-identifier hs-type">Region</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-554"></span><span id="fromProfile"><span class="annot"><span class="annottext">fromProfile :: Manager -&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromProfile"><span class="hs-identifier hs-var hs-var">fromProfile</span></a></span></span><span> </span><span id="local-6989586621679200555"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679200555"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-555"></span><span>  </span><span class="annot"><span class="annottext">IO (Auth, Maybe Region) -&gt; m (Auth, Maybe Region)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Auth, Maybe Region) -&gt; m (Auth, Maybe Region))
-&gt; IO (Auth, Maybe Region) -&gt; m (Auth, Maybe Region)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-556"></span><span>    </span><span id="local-6989586621679200554"><span class="annot"><span class="annottext">Either HttpException ByteString
</span><a href="#local-6989586621679200554"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; IO (Either HttpException ByteString)
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">Exception.try</span></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; IO (Either HttpException ByteString))
-&gt; IO ByteString -&gt; IO (Either HttpException ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Manager -&gt; Metadata -&gt; IO ByteString
forall (m :: * -&gt; *).
MonadIO m =&gt;
Manager -&gt; Metadata -&gt; m ByteString
</span><a href="Network.AWS.EC2.Metadata.html#metadata"><span class="hs-identifier hs-var">metadata</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679200555"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Info -&gt; Metadata
</span><a href="Network.AWS.EC2.Metadata.html#IAM"><span class="hs-identifier hs-var">IAM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; Info
</span><a href="Network.AWS.EC2.Metadata.html#SecurityCredentials"><span class="hs-identifier hs-var">SecurityCredentials</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>
</span><span id="line-558"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString]
</span><span class="hs-identifier hs-var">BS8.lines</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; [ByteString])
-&gt; Either HttpException ByteString
-&gt; Either HttpException [ByteString]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either HttpException ByteString
</span><a href="#local-6989586621679200554"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-559"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679200548"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679200548"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Manager -&gt; Text -&gt; IO (Auth, Maybe Region)
forall (m :: * -&gt; *).
MonadIO m =&gt;
Manager -&gt; Text -&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromProfileName"><span class="hs-identifier hs-var">fromProfileName</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679200555"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">Text.decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679200548"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679200546"><span class="annot"><span class="annottext">HttpException
</span><a href="#local-6989586621679200546"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AuthError -&gt; IO (Auth, Maybe Region)
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">Exception.throwIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpException -&gt; AuthError
</span><a href="Network.AWS.Auth.html#RetrievalError"><span class="hs-identifier hs-var">RetrievalError</span></a></span><span> </span><span class="annot"><span class="annottext">HttpException
</span><a href="#local-6989586621679200546"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>      </span><span class="annot"><span class="annottext">Either HttpException [ByteString]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-562"></span><span>        </span><span class="annot"><span class="annottext">AuthError -&gt; IO (Auth, Maybe Region)
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">Exception.throwIO</span></span><span> </span><span class="annot"><span class="annottext">(AuthError -&gt; IO (Auth, Maybe Region))
-&gt; AuthError -&gt; IO (Auth, Maybe Region)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-563"></span><span>          </span><span class="annot"><span class="annottext">Text -&gt; AuthError
</span><a href="Network.AWS.Auth.html#InvalidIAMError"><span class="hs-identifier hs-var">InvalidIAMError</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Unable to get default IAM Profile from EC2 metadata&quot;</span></span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span class="hs-comment">-- | Lookup a specific IAM Profile by name from the local EC2 instance-data.</span><span>
</span><span id="line-566"></span><span class="hs-comment">--</span><span>
</span><span id="line-567"></span><span class="hs-comment">-- Additionally starts a refresh thread for the given authentication environment.</span><span>
</span><span id="line-568"></span><span class="hs-comment">--</span><span>
</span><span id="line-569"></span><span class="hs-comment">-- The resulting 'IORef' wrapper + timer is designed so that multiple concurrent</span><span>
</span><span id="line-570"></span><span class="hs-comment">-- accesses of 'AuthEnv' from the 'AWS' environment are not required to calculate</span><span>
</span><span id="line-571"></span><span class="hs-comment">-- expiry and sequentially queue to update it.</span><span>
</span><span id="line-572"></span><span class="hs-comment">--</span><span>
</span><span id="line-573"></span><span class="hs-comment">-- The forked timer ensures a singular owner and pre-emptive refresh of the</span><span>
</span><span id="line-574"></span><span class="hs-comment">-- temporary session credentials before expiration.</span><span>
</span><span id="line-575"></span><span class="hs-comment">--</span><span>
</span><span id="line-576"></span><span class="hs-comment">-- A weak reference is used to ensure that the forked thread will eventually</span><span>
</span><span id="line-577"></span><span class="hs-comment">-- terminate when 'Auth' is no longer referenced.</span><span>
</span><span id="line-578"></span><span class="hs-comment">--</span><span>
</span><span id="line-579"></span><span class="hs-comment">-- If no session token or expiration time is present the credentials will</span><span>
</span><span id="line-580"></span><span class="hs-comment">-- be returned verbatim.</span><span>
</span><span id="line-581"></span><span id="local-6989586621679200915"><span class="annot"><a href="Network.AWS.Auth.html#fromProfileName"><span class="hs-identifier hs-type">fromProfileName</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-582"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679200915"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-583"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Client.Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-584"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-585"></span><span>  </span><span class="annot"><a href="#local-6989586621679200915"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-type">Auth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#Region"><span class="hs-identifier hs-type">Region</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-586"></span><span id="fromProfileName"><span class="annot"><span class="annottext">fromProfileName :: Manager -&gt; Text -&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromProfileName"><span class="hs-identifier hs-var hs-var">fromProfileName</span></a></span></span><span> </span><span id="local-6989586621679200545"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679200545"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679200544"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200544"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-587"></span><span>  </span><span class="annot"><span class="annottext">IO (Auth, Maybe Region) -&gt; m (Auth, Maybe Region)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Auth, Maybe Region) -&gt; m (Auth, Maybe Region))
-&gt; IO (Auth, Maybe Region) -&gt; m (Auth, Maybe Region)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-588"></span><span>    </span><span id="local-6989586621679200543"><span class="annot"><span class="annottext">Auth
</span><a href="#local-6989586621679200543"><span class="hs-identifier hs-var">auth</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO AuthEnv -&gt; IO Auth
</span><a href="Network.AWS.Auth.html#fetchAuthInBackground"><span class="hs-identifier hs-var">fetchAuthInBackground</span></a></span><span> </span><span class="annot"><span class="annottext">IO AuthEnv
</span><a href="#local-6989586621679200541"><span class="hs-identifier hs-var">getCredentials</span></a></span><span>
</span><span id="line-589"></span><span>    </span><span id="local-6989586621679200540"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621679200540"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Region
</span><a href="#local-6989586621679200539"><span class="hs-identifier hs-var">getRegion</span></a></span><span>
</span><span id="line-590"></span><span>
</span><span id="line-591"></span><span>    </span><span class="annot"><span class="annottext">(Auth, Maybe Region) -&gt; IO (Auth, Maybe Region)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Auth
</span><a href="#local-6989586621679200543"><span class="hs-identifier hs-var">auth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Region -&gt; Maybe Region
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621679200540"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-593"></span><span>    </span><span id="local-6989586621679200541"><span class="annot"><span class="annottext">getCredentials :: IO AuthEnv
</span><a href="#local-6989586621679200541"><span class="hs-identifier hs-var hs-var">getCredentials</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-594"></span><span>      </span><span class="annot"><span class="annottext">IO ByteString -&gt; IO (Either HttpException ByteString)
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">Exception.try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Manager -&gt; Metadata -&gt; IO ByteString
forall (m :: * -&gt; *).
MonadIO m =&gt;
Manager -&gt; Metadata -&gt; m ByteString
</span><a href="Network.AWS.EC2.Metadata.html#metadata"><span class="hs-identifier hs-var">metadata</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679200545"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Info -&gt; Metadata
</span><a href="Network.AWS.EC2.Metadata.html#IAM"><span class="hs-identifier hs-var">IAM</span></a></span><span> </span><span class="annot"><span class="annottext">(Info -&gt; Metadata)
-&gt; (Maybe Text -&gt; Info) -&gt; Maybe Text -&gt; Metadata
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; Info
</span><a href="Network.AWS.EC2.Metadata.html#SecurityCredentials"><span class="hs-identifier hs-var">SecurityCredentials</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Metadata) -&gt; Maybe Text -&gt; Metadata
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200544"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>        </span><span class="annot"><span class="annottext">IO (Either HttpException ByteString)
-&gt; (Either HttpException ByteString -&gt; IO AuthEnv) -&gt; IO AuthEnv
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either FilePath AuthEnv)
-&gt; (FilePath -&gt; AuthError)
-&gt; Either HttpException ByteString
-&gt; IO AuthEnv
forall e t a a.
Exception e =&gt;
(t -&gt; Either a a) -&gt; (a -&gt; e) -&gt; Either HttpException t -&gt; IO a
</span><a href="#local-6989586621679200538"><span class="hs-identifier hs-var">handleErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Either FilePath AuthEnv
forall a. FromJSON a =&gt; ByteString -&gt; Either FilePath a
</span><span class="hs-identifier hs-var">eitherDecode'</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either FilePath AuthEnv)
-&gt; (ByteString -&gt; ByteString)
-&gt; ByteString
-&gt; Either FilePath AuthEnv
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">LBS8.fromStrict</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; AuthError
</span><a href="#local-6989586621679200535"><span class="hs-identifier hs-var">invalidIAMErr</span></a></span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span>    </span><span id="local-6989586621679200539"><span class="annot"><span class="annottext">getRegion :: IO Region
</span><a href="#local-6989586621679200539"><span class="hs-identifier hs-var hs-var">getRegion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-598"></span><span>      </span><span class="annot"><span class="annottext">IO (Either FilePath IdentityDocument)
-&gt; IO (Either HttpException (Either FilePath IdentityDocument))
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">Exception.try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Manager -&gt; IO (Either FilePath IdentityDocument)
forall (m :: * -&gt; *).
MonadIO m =&gt;
Manager -&gt; m (Either FilePath IdentityDocument)
</span><a href="Network.AWS.EC2.Metadata.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679200545"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>        </span><span class="annot"><span class="annottext">IO (Either HttpException (Either FilePath IdentityDocument))
-&gt; (Either HttpException (Either FilePath IdentityDocument)
    -&gt; IO Region)
-&gt; IO Region
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(Either FilePath IdentityDocument -&gt; Either FilePath Region)
-&gt; (FilePath -&gt; AuthError)
-&gt; Either HttpException (Either FilePath IdentityDocument)
-&gt; IO Region
forall e t a a.
Exception e =&gt;
(t -&gt; Either a a) -&gt; (a -&gt; e) -&gt; Either HttpException t -&gt; IO a
</span><a href="#local-6989586621679200538"><span class="hs-identifier hs-var">handleErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(IdentityDocument -&gt; Region)
-&gt; Either FilePath IdentityDocument -&gt; Either FilePath Region
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">IdentityDocument -&gt; Region
</span><a href="Network.AWS.EC2.Metadata.html#%24sel%3A_region%3AIdentityDocument"><span class="hs-identifier hs-var hs-var">_region</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; AuthError
</span><a href="#local-6989586621679200532"><span class="hs-identifier hs-var">invalidIdentityErr</span></a></span><span>
</span><span id="line-600"></span><span>
</span><span id="line-601"></span><span>    </span><span id="local-6989586621679200538"><span class="annot"><span class="annottext">handleErr :: (t -&gt; Either a a) -&gt; (a -&gt; e) -&gt; Either HttpException t -&gt; IO a
</span><a href="#local-6989586621679200538"><span class="hs-identifier hs-var hs-var">handleErr</span></a></span></span><span> </span><span id="local-6989586621679200531"><span class="annot"><span class="annottext">t -&gt; Either a a
</span><a href="#local-6989586621679200531"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679200530"><span class="annot"><span class="annottext">a -&gt; e
</span><a href="#local-6989586621679200530"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-602"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679200529"><span class="annot"><span class="annottext">HttpException
</span><a href="#local-6989586621679200529"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AuthError -&gt; IO a
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">Exception.throwIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpException -&gt; AuthError
</span><a href="Network.AWS.Auth.html#RetrievalError"><span class="hs-identifier hs-var">RetrievalError</span></a></span><span> </span><span class="annot"><span class="annottext">HttpException
</span><a href="#local-6989586621679200529"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679200528"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679200528"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a -&gt; IO a) -&gt; (a -&gt; IO a) -&gt; Either a a -&gt; IO a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e -&gt; IO a
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">Exception.throwIO</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; IO a) -&gt; (a -&gt; e) -&gt; a -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; e
</span><a href="#local-6989586621679200530"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Either a a
</span><a href="#local-6989586621679200531"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679200528"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-604"></span><span>
</span><span id="line-605"></span><span>    </span><span id="local-6989586621679200535"><span class="annot"><span class="annottext">invalidIAMErr :: FilePath -&gt; AuthError
</span><a href="#local-6989586621679200535"><span class="hs-identifier hs-var hs-var">invalidIAMErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-606"></span><span>      </span><span class="annot"><span class="annottext">Text -&gt; AuthError
</span><a href="Network.AWS.Auth.html#InvalidIAMError"><span class="hs-identifier hs-var">InvalidIAMError</span></a></span><span>
</span><span id="line-607"></span><span>        </span><span class="annot"><span class="annottext">(Text -&gt; AuthError) -&gt; (FilePath -&gt; Text) -&gt; FilePath -&gt; AuthError
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Error parsing IAM profile '&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679200544"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;' &quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>        </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (FilePath -&gt; Text) -&gt; FilePath -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span>
</span><span id="line-609"></span><span>
</span><span id="line-610"></span><span>    </span><span id="local-6989586621679200532"><span class="annot"><span class="annottext">invalidIdentityErr :: FilePath -&gt; AuthError
</span><a href="#local-6989586621679200532"><span class="hs-identifier hs-var hs-var">invalidIdentityErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-611"></span><span>      </span><span class="annot"><span class="annottext">Text -&gt; AuthError
</span><a href="Network.AWS.Auth.html#InvalidIAMError"><span class="hs-identifier hs-var">InvalidIAMError</span></a></span><span>
</span><span id="line-612"></span><span>        </span><span class="annot"><span class="annottext">(Text -&gt; AuthError) -&gt; (FilePath -&gt; Text) -&gt; FilePath -&gt; AuthError
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Error parsing Instance Identity Document &quot;</span></span><span>
</span><span id="line-613"></span><span>        </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (FilePath -&gt; Text) -&gt; FilePath -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span class="hs-comment">-- | Obtain credentials exposed to a task via the ECS container agent, as</span><span>
</span><span id="line-616"></span><span class="hs-comment">-- described in the &lt;http://docs.aws.amazon.com/AmazonECS/latest/developerguide/task-iam-roles.html IAM Roles for Tasks&gt;</span><span>
</span><span id="line-617"></span><span class="hs-comment">-- section of the AWS ECS documentation. The credentials are obtained by making</span><span>
</span><span id="line-618"></span><span class="hs-comment">-- a request to &lt;http://169.254.170.2&gt; at the path contained by the</span><span>
</span><span id="line-619"></span><span class="hs-comment">-- 'envContainerCredentialsURI' environment variable.</span><span>
</span><span id="line-620"></span><span class="hs-comment">--</span><span>
</span><span id="line-621"></span><span class="hs-comment">-- The ECS container agent provides an access key, secret key, session token,</span><span>
</span><span id="line-622"></span><span class="hs-comment">-- and expiration time, but it does not include a region, so the region will</span><span>
</span><span id="line-623"></span><span class="hs-comment">-- attempt to be determined from the 'envRegion' environment variable if it is</span><span>
</span><span id="line-624"></span><span class="hs-comment">-- set.</span><span>
</span><span id="line-625"></span><span class="hs-comment">--</span><span>
</span><span id="line-626"></span><span class="hs-comment">-- Like 'fromProfileName', additionally starts a refresh thread that will</span><span>
</span><span id="line-627"></span><span class="hs-comment">-- periodically fetch fresh credentials before the current ones expire.</span><span>
</span><span id="line-628"></span><span class="hs-comment">--</span><span>
</span><span id="line-629"></span><span class="hs-comment">-- Throws 'MissingEnvError' if the 'envContainerCredentialsURI' environment</span><span>
</span><span id="line-630"></span><span class="hs-comment">-- variable is not set or 'InvalidIAMError' if the payload returned by the ECS</span><span>
</span><span id="line-631"></span><span class="hs-comment">-- container agent is not of the expected format.</span><span>
</span><span id="line-632"></span><span id="local-6989586621679200913"><span class="annot"><a href="Network.AWS.Auth.html#fromContainer"><span class="hs-identifier hs-type">fromContainer</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-633"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679200913"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-634"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Client.Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-635"></span><span>  </span><span class="annot"><a href="#local-6989586621679200913"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-type">Auth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#Region"><span class="hs-identifier hs-type">Region</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-636"></span><span id="fromContainer"><span class="annot"><span class="annottext">fromContainer :: Manager -&gt; m (Auth, Maybe Region)
</span><a href="Network.AWS.Auth.html#fromContainer"><span class="hs-identifier hs-var hs-var">fromContainer</span></a></span></span><span> </span><span id="local-6989586621679200527"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679200527"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-637"></span><span>  </span><span class="annot"><span class="annottext">IO (Auth, Maybe Region) -&gt; m (Auth, Maybe Region)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Auth, Maybe Region) -&gt; m (Auth, Maybe Region))
-&gt; IO (Auth, Maybe Region) -&gt; m (Auth, Maybe Region)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-638"></span><span>    </span><span id="local-6989586621679200526"><span class="annot"><span class="annottext">ClientRequest
</span><a href="#local-6989586621679200526"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ClientRequest
</span><a href="#local-6989586621679200525"><span class="hs-identifier hs-var">getCredentialsURI</span></a></span><span>
</span><span id="line-639"></span><span>    </span><span id="local-6989586621679200524"><span class="annot"><span class="annottext">Auth
</span><a href="#local-6989586621679200524"><span class="hs-identifier hs-var">auth</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO AuthEnv -&gt; IO Auth
</span><a href="Network.AWS.Auth.html#fetchAuthInBackground"><span class="hs-identifier hs-var">fetchAuthInBackground</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClientRequest -&gt; IO AuthEnv
</span><a href="#local-6989586621679200523"><span class="hs-identifier hs-var">renew</span></a></span><span> </span><span class="annot"><span class="annottext">ClientRequest
</span><a href="#local-6989586621679200526"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>    </span><span id="local-6989586621679200522"><span class="annot"><span class="annottext">Maybe Region
</span><a href="#local-6989586621679200522"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Region)
</span><a href="#local-6989586621679200521"><span class="hs-identifier hs-var">getRegion</span></a></span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span><span>    </span><span class="annot"><span class="annottext">(Auth, Maybe Region) -&gt; IO (Auth, Maybe Region)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Auth
</span><a href="#local-6989586621679200524"><span class="hs-identifier hs-var">auth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Region
</span><a href="#local-6989586621679200522"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-644"></span><span>    </span><span class="annot"><a href="#local-6989586621679200525"><span class="hs-identifier hs-type">getCredentialsURI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#ClientRequest"><span class="hs-identifier hs-type">ClientRequest</span></a></span><span>
</span><span id="line-645"></span><span>    </span><span id="local-6989586621679200525"><span class="annot"><span class="annottext">getCredentialsURI :: IO ClientRequest
</span><a href="#local-6989586621679200525"><span class="hs-identifier hs-var hs-var">getCredentialsURI</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-646"></span><span>      </span><span id="local-6989586621679200520"><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679200520"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Maybe FilePath)
</span><span class="hs-identifier hs-var">Environment.lookupEnv</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">Text.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Network.AWS.Auth.html#envContainerCredentialsURI"><span class="hs-identifier hs-var">envContainerCredentialsURI</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span>      </span><span id="local-6989586621679200519"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200519"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-648"></span><span>        </span><span class="annot"><span class="annottext">IO FilePath
-&gt; (FilePath -&gt; IO FilePath) -&gt; Maybe FilePath -&gt; IO FilePath
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span>
</span><span id="line-649"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthError -&gt; IO FilePath
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">Exception.throwIO</span></span><span> </span><span class="annot"><span class="annottext">(AuthError -&gt; IO FilePath)
-&gt; (Text -&gt; AuthError) -&gt; Text -&gt; IO FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; AuthError
</span><a href="Network.AWS.Auth.html#MissingEnvError"><span class="hs-identifier hs-var">MissingEnvError</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO FilePath) -&gt; Text -&gt; IO FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Unable to read ENV variable: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Network.AWS.Auth.html#envContainerCredentialsURI"><span class="hs-identifier hs-var">envContainerCredentialsURI</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-650"></span><span>          </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-651"></span><span>          </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679200520"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; IO ClientRequest
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m ClientRequest
</span><span class="hs-identifier hs-var">Client.parseUrlThrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;http://169.254.170.2&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200519"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span>
</span><span id="line-655"></span><span>    </span><span class="annot"><a href="#local-6989586621679200523"><span class="hs-identifier hs-type">renew</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.AWS.Types.html#ClientRequest"><span class="hs-identifier hs-type">ClientRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#AuthEnv"><span class="hs-identifier hs-type">AuthEnv</span></a></span><span>
</span><span id="line-656"></span><span>    </span><span id="local-6989586621679200523"><span class="annot"><span class="annottext">renew :: ClientRequest -&gt; IO AuthEnv
</span><a href="#local-6989586621679200523"><span class="hs-identifier hs-var hs-var">renew</span></a></span></span><span> </span><span id="local-6989586621679200517"><span class="annot"><span class="annottext">ClientRequest
</span><a href="#local-6989586621679200517"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-657"></span><span>      </span><span id="local-6989586621679200516"><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679200516"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ClientRequest -&gt; Manager -&gt; IO (Response ByteString)
</span><span class="hs-identifier hs-var">Client.httpLbs</span></span><span> </span><span class="annot"><span class="annottext">ClientRequest
</span><a href="#local-6989586621679200517"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679200527"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span>      </span><span class="annot"><span class="annottext">(FilePath -&gt; IO AuthEnv)
-&gt; (AuthEnv -&gt; IO AuthEnv) -&gt; Either FilePath AuthEnv -&gt; IO AuthEnv
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span>
</span><span id="line-660"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthError -&gt; IO AuthEnv
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">Exception.throwIO</span></span><span> </span><span class="annot"><span class="annottext">(AuthError -&gt; IO AuthEnv)
-&gt; (FilePath -&gt; AuthError) -&gt; FilePath -&gt; IO AuthEnv
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; AuthError
</span><a href="#local-6989586621679200514"><span class="hs-identifier hs-var">invalidIdentityErr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-661"></span><span>        </span><span class="annot"><span class="annottext">AuthEnv -&gt; IO AuthEnv
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-662"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Either FilePath AuthEnv
forall a. FromJSON a =&gt; ByteString -&gt; Either FilePath a
</span><span class="hs-identifier hs-var">eitherDecode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response ByteString -&gt; ByteString
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">Client.responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679200516"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-663"></span><span>
</span><span id="line-664"></span><span>    </span><span id="local-6989586621679200514"><span class="annot"><span class="annottext">invalidIdentityErr :: FilePath -&gt; AuthError
</span><a href="#local-6989586621679200514"><span class="hs-identifier hs-var hs-var">invalidIdentityErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-665"></span><span>      </span><span class="annot"><span class="annottext">Text -&gt; AuthError
</span><a href="Network.AWS.Auth.html#InvalidIAMError"><span class="hs-identifier hs-var">InvalidIAMError</span></a></span><span>
</span><span id="line-666"></span><span>        </span><span class="annot"><span class="annottext">(Text -&gt; AuthError) -&gt; (FilePath -&gt; Text) -&gt; FilePath -&gt; AuthError
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Error parsing Task Identity Document &quot;</span></span><span>
</span><span id="line-667"></span><span>        </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (FilePath -&gt; Text) -&gt; FilePath -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span>
</span><span id="line-668"></span><span>
</span><span id="line-669"></span><span>    </span><span class="annot"><a href="#local-6989586621679200521"><span class="hs-identifier hs-type">getRegion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#Region"><span class="hs-identifier hs-type">Region</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>    </span><span id="local-6989586621679200521"><span class="annot"><span class="annottext">getRegion :: IO (Maybe Region)
</span><a href="#local-6989586621679200521"><span class="hs-identifier hs-var hs-var">getRegion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeT IO Region -&gt; IO (Maybe Region)
forall (m :: * -&gt; *) a. MaybeT m a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var hs-var">runMaybeT</span></span><span> </span><span class="annot"><span class="annottext">(MaybeT IO Region -&gt; IO (Maybe Region))
-&gt; MaybeT IO Region -&gt; IO (Maybe Region)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-671"></span><span>      </span><span id="local-6989586621679200510"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200510"><span class="hs-identifier hs-var">mr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe FilePath) -&gt; MaybeT IO FilePath
forall (m :: * -&gt; *) a. m (Maybe a) -&gt; MaybeT m a
</span><span class="hs-identifier hs-var">MaybeT</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe FilePath) -&gt; MaybeT IO FilePath)
-&gt; (IO (Maybe FilePath) -&gt; IO (Maybe FilePath))
-&gt; IO (Maybe FilePath)
-&gt; MaybeT IO FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO (Maybe FilePath) -&gt; IO (Maybe FilePath)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe FilePath) -&gt; MaybeT IO FilePath)
-&gt; IO (Maybe FilePath) -&gt; MaybeT IO FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Maybe FilePath)
</span><span class="hs-identifier hs-var">Environment.lookupEnv</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">Text.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Network.AWS.Auth.html#envRegion"><span class="hs-identifier hs-var">envRegion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span>      </span><span class="annot"><span class="annottext">(FilePath -&gt; MaybeT IO Region)
-&gt; (Region -&gt; MaybeT IO Region)
-&gt; Either FilePath Region
-&gt; MaybeT IO Region
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span>
</span><span id="line-674"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MaybeT IO Region -&gt; FilePath -&gt; MaybeT IO Region
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(MaybeT IO Region -&gt; FilePath -&gt; MaybeT IO Region)
-&gt; (IO (Maybe Region) -&gt; MaybeT IO Region)
-&gt; IO (Maybe Region)
-&gt; FilePath
-&gt; MaybeT IO Region
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO (Maybe Region) -&gt; MaybeT IO Region
forall (m :: * -&gt; *) a. m (Maybe a) -&gt; MaybeT m a
</span><span class="hs-identifier hs-var">MaybeT</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Region) -&gt; FilePath -&gt; MaybeT IO Region)
-&gt; IO (Maybe Region) -&gt; FilePath -&gt; MaybeT IO Region
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Region -&gt; IO (Maybe Region)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Region
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-675"></span><span>        </span><span class="annot"><span class="annottext">Region -&gt; MaybeT IO Region
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-676"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Either FilePath Region
forall a. FromText a =&gt; Text -&gt; Either FilePath a
</span><a href="Network.AWS.Data.Text.html#fromText"><span class="hs-identifier hs-var">fromText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679200510"><span class="hs-identifier hs-var">mr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span class="hs-comment">-- | Implements the background fetching behavior used by 'fromProfileName' and</span><span>
</span><span id="line-679"></span><span class="hs-comment">-- 'fromContainer'. Given an 'IO' action that produces an 'AuthEnv', this spawns</span><span>
</span><span id="line-680"></span><span class="hs-comment">-- a thread that mutates the 'IORef' returned in the resulting 'Auth' to keep</span><span>
</span><span id="line-681"></span><span class="hs-comment">-- the temporary credentials up to date.</span><span>
</span><span id="line-682"></span><span class="annot"><a href="Network.AWS.Auth.html#fetchAuthInBackground"><span class="hs-identifier hs-type">fetchAuthInBackground</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#AuthEnv"><span class="hs-identifier hs-type">AuthEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-type">Auth</span></a></span><span>
</span><span id="line-683"></span><span id="fetchAuthInBackground"><span class="annot"><span class="annottext">fetchAuthInBackground :: IO AuthEnv -&gt; IO Auth
</span><a href="Network.AWS.Auth.html#fetchAuthInBackground"><span class="hs-identifier hs-var hs-var">fetchAuthInBackground</span></a></span></span><span> </span><span id="local-6989586621679200507"><span class="annot"><span class="annottext">IO AuthEnv
</span><a href="#local-6989586621679200507"><span class="hs-identifier hs-var">menv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-684"></span><span>  </span><span class="annot"><span class="annottext">IO AuthEnv
</span><a href="#local-6989586621679200507"><span class="hs-identifier hs-var">menv</span></a></span><span> </span><span class="annot"><span class="annottext">IO AuthEnv -&gt; (AuthEnv -&gt; IO Auth) -&gt; IO Auth
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679200506"><span class="annot"><span class="annottext">AuthEnv
</span><a href="#local-6989586621679200506"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO Auth -&gt; IO Auth
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Auth -&gt; IO Auth) -&gt; IO Auth -&gt; IO Auth
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-685"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AuthEnv -&gt; Maybe ISO8601
</span><a href="Network.AWS.Types.html#%24sel%3A_authExpiration%3AAuthEnv"><span class="hs-identifier hs-var hs-var">_authExpiration</span></a></span><span> </span><span class="annot"><span class="annottext">AuthEnv
</span><a href="#local-6989586621679200506"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-686"></span><span>      </span><span class="annot"><span class="annottext">Maybe ISO8601
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Auth -&gt; IO Auth
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthEnv -&gt; Auth
</span><a href="Network.AWS.Types.html#Auth"><span class="hs-identifier hs-var">Auth</span></a></span><span> </span><span class="annot"><span class="annottext">AuthEnv
</span><a href="#local-6989586621679200506"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679200504"><span class="annot"><span class="annottext">ISO8601
</span><a href="#local-6989586621679200504"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-688"></span><span>        </span><span id="local-6989586621679200503"><span class="annot"><span class="annottext">IORef AuthEnv
</span><a href="#local-6989586621679200503"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AuthEnv -&gt; IO (IORef AuthEnv)
forall a. a -&gt; IO (IORef a)
</span><span class="hs-identifier hs-var">IORef.newIORef</span></span><span> </span><span class="annot"><span class="annottext">AuthEnv
</span><a href="#local-6989586621679200506"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-689"></span><span>        </span><span id="local-6989586621679200501"><span class="annot"><span class="annottext">ThreadId
</span><a href="#local-6989586621679200501"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ThreadId
</span><span class="hs-identifier hs-var">Concurrent.myThreadId</span></span><span>
</span><span id="line-690"></span><span>        </span><span id="local-6989586621679200499"><span class="annot"><span class="annottext">ThreadId
</span><a href="#local-6989586621679200499"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO AuthEnv -&gt; IORef AuthEnv -&gt; ThreadId -&gt; ISO8601 -&gt; IO ThreadId
</span><a href="#local-6989586621679200498"><span class="hs-identifier hs-var">timer</span></a></span><span> </span><span class="annot"><span class="annottext">IO AuthEnv
</span><a href="#local-6989586621679200507"><span class="hs-identifier hs-var">menv</span></a></span><span> </span><span class="annot"><span class="annottext">IORef AuthEnv
</span><a href="#local-6989586621679200503"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">ThreadId
</span><a href="#local-6989586621679200501"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ISO8601
</span><a href="#local-6989586621679200504"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-691"></span><span>
</span><span id="line-692"></span><span>        </span><span class="annot"><span class="annottext">Auth -&gt; IO Auth
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThreadId -&gt; IORef AuthEnv -&gt; Auth
</span><a href="Network.AWS.Types.html#Ref"><span class="hs-identifier hs-var">Ref</span></a></span><span> </span><span class="annot"><span class="annottext">ThreadId
</span><a href="#local-6989586621679200499"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">IORef AuthEnv
</span><a href="#local-6989586621679200503"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-694"></span><span>    </span><span class="annot"><a href="#local-6989586621679200498"><span class="hs-identifier hs-type">timer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#AuthEnv"><span class="hs-identifier hs-type">AuthEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IORef</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#AuthEnv"><span class="hs-identifier hs-type">AuthEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ThreadId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.AWS.Data.Time.html#ISO8601"><span class="hs-identifier hs-type">ISO8601</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ThreadId</span></span><span>
</span><span id="line-695"></span><span>    </span><span id="local-6989586621679200498"><span class="annot"><span class="annottext">timer :: IO AuthEnv -&gt; IORef AuthEnv -&gt; ThreadId -&gt; ISO8601 -&gt; IO ThreadId
</span><a href="#local-6989586621679200498"><span class="hs-identifier hs-var hs-var">timer</span></a></span></span><span> </span><span id="local-6989586621679200496"><span class="annot"><span class="annottext">IO AuthEnv
</span><a href="#local-6989586621679200496"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679200495"><span class="annot"><span class="annottext">IORef AuthEnv
</span><a href="#local-6989586621679200495"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679200494"><span class="annot"><span class="annottext">ThreadId
</span><a href="#local-6989586621679200494"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679200493"><span class="annot"><span class="annottext">ISO8601
</span><a href="#local-6989586621679200493"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-696"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><span class="hs-identifier hs-var">Concurrent.forkIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ThreadId) -&gt; IO () -&gt; IO ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-697"></span><span>        </span><span id="local-6989586621679200491"><span class="annot"><span class="annottext">ThreadId
</span><a href="#local-6989586621679200491"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ThreadId
</span><span class="hs-identifier hs-var">Concurrent.myThreadId</span></span><span>
</span><span id="line-698"></span><span>        </span><span id="local-6989586621679200490"><span class="annot"><span class="annottext">Weak (IORef AuthEnv)
</span><a href="#local-6989586621679200490"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IORef AuthEnv -&gt; IO () -&gt; IO (Weak (IORef AuthEnv))
forall a. IORef a -&gt; IO () -&gt; IO (Weak (IORef a))
</span><span class="hs-identifier hs-var">IORef.mkWeakIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef AuthEnv
</span><a href="#local-6989586621679200495"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThreadId -&gt; IO ()
</span><span class="hs-identifier hs-var">Concurrent.killThread</span></span><span> </span><span class="annot"><span class="annottext">ThreadId
</span><a href="#local-6989586621679200491"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-699"></span><span>
</span><span id="line-700"></span><span>        </span><span class="annot"><span class="annottext">IO AuthEnv -&gt; Weak (IORef AuthEnv) -&gt; ThreadId -&gt; ISO8601 -&gt; IO ()
</span><a href="#local-6989586621679200487"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">IO AuthEnv
</span><a href="#local-6989586621679200496"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">Weak (IORef AuthEnv)
</span><a href="#local-6989586621679200490"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">ThreadId
</span><a href="#local-6989586621679200494"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ISO8601
</span><a href="#local-6989586621679200493"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span>    </span><span class="annot"><a href="#local-6989586621679200487"><span class="hs-identifier hs-type">loop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#AuthEnv"><span class="hs-identifier hs-type">AuthEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Weak</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IORef</span></span><span> </span><span class="annot"><a href="Network.AWS.Types.html#AuthEnv"><span class="hs-identifier hs-type">AuthEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ThreadId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.AWS.Data.Time.html#ISO8601"><span class="hs-identifier hs-type">ISO8601</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-703"></span><span>    </span><span id="local-6989586621679200487"><span class="annot"><span class="annottext">loop :: IO AuthEnv -&gt; Weak (IORef AuthEnv) -&gt; ThreadId -&gt; ISO8601 -&gt; IO ()
</span><a href="#local-6989586621679200487"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679200486"><span class="annot"><span class="annottext">IO AuthEnv
</span><a href="#local-6989586621679200486"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span id="local-6989586621679200485"><span class="annot"><span class="annottext">Weak (IORef AuthEnv)
</span><a href="#local-6989586621679200485"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679200484"><span class="annot"><span class="annottext">ThreadId
</span><a href="#local-6989586621679200484"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679200483"><span class="annot"><span class="annottext">ISO8601
</span><a href="#local-6989586621679200483"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-704"></span><span>      </span><span class="annot"><span class="annottext">ISO8601 -&gt; UTCTime -&gt; Int
forall a (a :: Format). Integral a =&gt; Time a -&gt; UTCTime -&gt; a
</span><a href="#local-6989586621679200482"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">ISO8601
</span><a href="#local-6989586621679200483"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; Int) -&gt; IO UTCTime -&gt; IO Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO UTCTime
</span><span class="hs-identifier hs-var">Time.getCurrentTime</span></span><span> </span><span class="annot"><span class="annottext">IO Int -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><span class="hs-identifier hs-var">Concurrent.threadDelay</span></span><span>
</span><span id="line-705"></span><span>      </span><span id="local-6989586621679200479"><span class="annot"><span class="annottext">Either HttpException AuthEnv
</span><a href="#local-6989586621679200479"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO AuthEnv -&gt; IO (Either HttpException AuthEnv)
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">Exception.try</span></span><span> </span><span class="annot"><span class="annottext">IO AuthEnv
</span><a href="#local-6989586621679200486"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-706"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either HttpException AuthEnv
</span><a href="#local-6989586621679200479"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-707"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679200478"><span class="annot"><span class="annottext">HttpException
</span><a href="#local-6989586621679200478"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ThreadId -&gt; AuthError -&gt; IO ()
forall e. Exception e =&gt; ThreadId -&gt; e -&gt; IO ()
</span><span class="hs-identifier hs-var">Exception.throwTo</span></span><span> </span><span class="annot"><span class="annottext">ThreadId
</span><a href="#local-6989586621679200484"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpException -&gt; AuthError
</span><a href="Network.AWS.Auth.html#RetrievalError"><span class="hs-identifier hs-var">RetrievalError</span></a></span><span> </span><span class="annot"><span class="annottext">HttpException
</span><a href="#local-6989586621679200478"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-708"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679200476"><span class="annot"><span class="annottext">AuthEnv
</span><a href="#local-6989586621679200476"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-709"></span><span>          </span><span id="local-6989586621679200475"><span class="annot"><span class="annottext">Maybe (IORef AuthEnv)
</span><a href="#local-6989586621679200475"><span class="hs-identifier hs-var">mr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Weak (IORef AuthEnv) -&gt; IO (Maybe (IORef AuthEnv))
forall v. Weak v -&gt; IO (Maybe v)
</span><span class="hs-identifier hs-var">Weak.deRefWeak</span></span><span> </span><span class="annot"><span class="annottext">Weak (IORef AuthEnv)
</span><a href="#local-6989586621679200485"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-710"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (IORef AuthEnv)
</span><a href="#local-6989586621679200475"><span class="hs-identifier hs-var">mr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-711"></span><span>            </span><span class="annot"><span class="annottext">Maybe (IORef AuthEnv)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679200473"><span class="annot"><span class="annottext">IORef AuthEnv
</span><a href="#local-6989586621679200473"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-713"></span><span>              </span><span class="annot"><span class="annottext">IORef AuthEnv -&gt; AuthEnv -&gt; IO ()
forall a. IORef a -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">IORef.atomicWriteIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef AuthEnv
</span><a href="#local-6989586621679200473"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">AuthEnv
</span><a href="#local-6989586621679200476"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-714"></span><span>              </span><span class="annot"><span class="annottext">IO () -&gt; (ISO8601 -&gt; IO ()) -&gt; Maybe ISO8601 -&gt; IO ()
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO AuthEnv -&gt; Weak (IORef AuthEnv) -&gt; ThreadId -&gt; ISO8601 -&gt; IO ()
</span><a href="#local-6989586621679200487"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">IO AuthEnv
</span><a href="#local-6989586621679200486"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">Weak (IORef AuthEnv)
</span><a href="#local-6989586621679200485"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">ThreadId
</span><a href="#local-6989586621679200484"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthEnv -&gt; Maybe ISO8601
</span><a href="Network.AWS.Types.html#%24sel%3A_authExpiration%3AAuthEnv"><span class="hs-identifier hs-var hs-var">_authExpiration</span></a></span><span> </span><span class="annot"><span class="annottext">AuthEnv
</span><a href="#local-6989586621679200476"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-715"></span><span>
</span><span id="line-716"></span><span>    </span><span id="local-6989586621679200482"><span class="annot"><span class="annottext">diff :: Time a -&gt; UTCTime -&gt; a
</span><a href="#local-6989586621679200482"><span class="hs-identifier hs-var hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.AWS.Data.Time.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679200471"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679200471"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679200470"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679200470"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1000000</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679200468"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679200468"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span>
</span><span id="line-717"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-718"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679200468"><span class="annot"><span class="annottext">n :: a
</span><a href="#local-6989586621679200468"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; a
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">truncate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; NominalDiffTime
</span><span class="hs-identifier hs-var">Time.diffUTCTime</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679200471"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679200470"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">60</span></span><span>
</span><span id="line-719"></span></pre></body></html>